import{f as U,e as z,b as _,r as m,j as e,t as ys,D as vt,c as $,E as ks,B as I,o as O,a as H,F as jt,G as bt,H as wt,I as Nt,J as yt,K as kt,L as Ss,d as be,M as _e,N as St,v as Tt,i as ze,P as Ct,s as Mt,y as ce,Q as At,k as as,V as _t,T as Dt,u as It,U as os,W as rs,X as Et}from"./browser-ByRVlxZs.js";import{A as Rt,M as De,u as Pt,a as Ts}from"./markdown-BGjOwmZo.js";import{u as Ft}from"./use-tabs-DAltGTM0.js";import{c as Cs,u as Ot,P as Ie}from"./index-2emEW3K2.js";import{c as Ms,R as $t,W as Lt,C as zt,T as Ut,D as Vt,a as As,P as Bt,O as Ht,b as qt}from"./index-BLI4MUby.js";import{c as Te}from"./index-Dc_FVRD7.js";import{b as Gt,A as Wt,I as is,c as Jt,D as ls,T as Kt,d as cs,S as Qt,e as _s,M as Xt,C as Yt,f as Zt,g as en}from"./app-icon-D6xJYLb3.js";import{a as ds,b as us,c as ms,C as sn,d as tn,e as nn,f as an,g as on,h as rn,P as ln}from"./prompt-input-DydAtBQM.js";import{D as Ee,a as Re,b as Pe,c as Fe,e as Xe,d as Ds}from"./dialog-CXGJl-o7.js";import{I as cn}from"./input-b4JxTlpn.js";import{L as Ue}from"./label-BtiHOr9H.js";import{C as me}from"./chevron-down-goFeZl_H.js";import{T as dn}from"./icons-CW3DX_3H.js";import{B as xe}from"./badge-C-47JFJQ.js";import{C as un}from"./chevron-right-Bveoklej.js";import{R as hs,C as Oe}from"./rotate-ccw-DoeC82aJ.js";import{V as mn,M as hn,I as xn,C as fn,b as pn}from"./provider-metadata-CugWU6eq.js";import{D as qe,a as Ge,b as We,c as W,d as fe,e as Is,f as Es,g as Rs,h as gn,i as vn,u as jn,j as Ps,R as bn,I as wn}from"./dropdown-menu-C1Ey9eto.js";import{S as Nn}from"./settings-QCWEOfoD.js";import{E as Fs}from"./external-link-CNRFkGVF.js";import{T as yn,a as Je,b as Ke,c as Qe}from"./tooltip-CuHm1DfS.js";import{u as Os}from"./use-app-state-XN3_o-A1.js";import{A as $s,a as Ls}from"./alert-C0unLOum.js";import{S as kn}from"./search-D46bnQJV.js";import{u as Sn,P as Tn}from"./index-DCjjJrI9.js";import{P as Cn}from"./plus-Df7A54Wp.js";import"./x-CEbMeDD8.js";import"./logo-CYjnf5Jp.js";import"./sun-DU-usQ9G.js";import"./check-C4BuViip.js";import"./ai-provider-guard-dialog-CqR3tf4a.js";import"./supported-providers-DL_mBpue.js";import"./animated-logo-m8857RJK.js";import"./index-DBjN4Su_.js";import"./index-CBgJt7o6.js";import"./has-ai-provider-CMHwJ9oN.js";import"./circle-DigxURo9.js";import"./react-MNBroJ8M.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],zs=U("brain",Mn);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ye=U("circle-question-mark",An);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Ze=U("copy",_n);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dn=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],In=U("ellipsis-vertical",Dn);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Us=U("eye",En);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]],Pn=U("file-plus",Rn);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fn=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],xs=U("folder-open",Fn);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],$n=U("folder-tree",On);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],zn=U("git-branch",Ln);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Un=[["path",{d:"M12 3v6",key:"1holv5"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"M12 15v6",key:"a9ows0"}]],Vs=U("git-commit-vertical",Un);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Bn=U("history",Vn);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],qn=U("panel-left-close",Hn);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],Wn=U("pen-line",Gn);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Bs=U("save",Jn);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],Qn=U("stethoscope",Kn);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xn=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Yn=U("trash-2",Xn);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ye=U("triangle-alert",Zn);function ea(t){return t.replace("tool-","")}function sa({navigateOnDelete:t}){const s=z(_.workspace.project.trash.mutationOptions()),{addTab:n,closeTab:a,data:r,selectTab:o}=Ft(),i=m.useCallback(async c=>{await s.mutateAsync({subdomain:c});const d=r.tabs.filter(u=>u.pathname.includes(`/projects/${c}`));{const u=r.tabs.find(f=>f.pathname==="/new-tab"||f.pathname==="/");await(u?o({id:u.id}):n({urlPath:"/new-tab"}))}for(const u of d)await a({id:u.id})},[s,r.tabs,a,n,o,t]);return{error:s.error,isPending:s.isPending,trashApp:i}}var Hs="AlertDialog",[ta,ur]=Cs(Hs,[Ms]),oe=Ms(),qs=t=>{const{__scopeAlertDialog:s,...n}=t,a=oe(s);return e.jsx($t,{...a,...n,modal:!0})};qs.displayName=Hs;var na="AlertDialogTrigger",aa=m.forwardRef((t,s)=>{const{__scopeAlertDialog:n,...a}=t,r=oe(n);return e.jsx(qt,{...r,...a,ref:s})});aa.displayName=na;var oa="AlertDialogPortal",Gs=t=>{const{__scopeAlertDialog:s,...n}=t,a=oe(s);return e.jsx(Bt,{...a,...n})};Gs.displayName=oa;var ra="AlertDialogOverlay",Ws=m.forwardRef((t,s)=>{const{__scopeAlertDialog:n,...a}=t,r=oe(n);return e.jsx(Ht,{...r,...a,ref:s})});Ws.displayName=ra;var je="AlertDialogContent",[ia,la]=ta(je),ca=vt("AlertDialogContent"),Js=m.forwardRef((t,s)=>{const{__scopeAlertDialog:n,children:a,...r}=t,o=oe(n),i=m.useRef(null),c=ys(s,i),d=m.useRef(null);return e.jsx(Lt,{contentName:je,titleName:Ks,docsSlug:"alert-dialog",children:e.jsx(ia,{scope:n,cancelRef:d,children:e.jsxs(zt,{role:"alertdialog",...o,...r,ref:c,onOpenAutoFocus:Te(r.onOpenAutoFocus,u=>{u.preventDefault(),d.current?.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[e.jsx(ca,{children:a}),e.jsx(ua,{contentRef:i})]})})})});Js.displayName=je;var Ks="AlertDialogTitle",Qs=m.forwardRef((t,s)=>{const{__scopeAlertDialog:n,...a}=t,r=oe(n);return e.jsx(Ut,{...r,...a,ref:s})});Qs.displayName=Ks;var Xs="AlertDialogDescription",Ys=m.forwardRef((t,s)=>{const{__scopeAlertDialog:n,...a}=t,r=oe(n);return e.jsx(Vt,{...r,...a,ref:s})});Ys.displayName=Xs;var da="AlertDialogAction",Zs=m.forwardRef((t,s)=>{const{__scopeAlertDialog:n,...a}=t,r=oe(n);return e.jsx(As,{...r,...a,ref:s})});Zs.displayName=da;var et="AlertDialogCancel",st=m.forwardRef((t,s)=>{const{__scopeAlertDialog:n,...a}=t,{cancelRef:r}=la(et,n),o=oe(n),i=ys(s,r);return e.jsx(As,{...o,...a,ref:i})});st.displayName=et;var ua=({contentRef:t})=>{const s=`\`${je}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${je}\` by passing a \`${Xs}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${je}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return m.useEffect(()=>{document.getElementById(t.current?.getAttribute("aria-describedby"))||console.warn(s)},[s,t]),null},ma=qs,ha=Gs,xa=Ws,fa=Js,pa=Zs,ga=st,va=Qs,ja=Ys;function ba({...t}){return e.jsx(ma,{"data-slot":"alert-dialog",...t})}function wa({className:t,...s}){return e.jsx(pa,{className:$(ks(),t),...s})}function Na({className:t,...s}){return e.jsx(ga,{className:$(ks({variant:"outline"}),t),...s})}function ya({className:t,...s}){return e.jsxs(Ma,{children:[e.jsx(Ca,{}),e.jsx(fa,{className:$("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),"data-slot":"alert-dialog-content",...s})]})}function ka({className:t,...s}){return e.jsx(ja,{className:$("text-muted-foreground text-sm",t),"data-slot":"alert-dialog-description",...s})}function Sa({className:t,...s}){return e.jsx("div",{className:$("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),"data-slot":"alert-dialog-footer",...s})}function Ta({className:t,...s}){return e.jsx("div",{className:$("flex flex-col gap-2 text-center sm:text-left",t),"data-slot":"alert-dialog-header",...s})}function Ca({className:t,...s}){return e.jsx(xa,{className:$("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),"data-slot":"alert-dialog-overlay",...s})}function Ma({...t}){return e.jsx(ha,{"data-slot":"alert-dialog-portal",...t})}function Aa({className:t,...s}){return e.jsx(va,{className:$("text-lg font-semibold",t),"data-slot":"alert-dialog-title",...s})}function _a({onOpenChange:t,open:s,project:n}){const{isPending:a,trashApp:r}=sa({navigateOnDelete:!0}),o=async()=>{try{await r(n.subdomain),t(!1)}catch{O.error("Failed to delete project")}};return e.jsx(ba,{onOpenChange:t,open:s,children:e.jsxs(ya,{children:[e.jsxs(Ta,{children:[e.jsxs(Aa,{children:["Delete ",e.jsx("b",{children:n.title}),"?"]}),e.jsxs(ka,{children:["This will move the “",e.jsx("b",{children:n.title}),"” project to the trash."]})]}),e.jsxs(Sa,{children:[e.jsx(Na,{disabled:a,children:"Cancel"}),e.jsx(wa,{asChild:!0,className:"text-white",disabled:a,onClick:o,children:e.jsx(I,{variant:"destructive",children:a?"Deleting...":"Delete"})})]})]})})}function Da({dialogTitle:t,onOpenChange:s,open:n,subdomain:a}){const[r,o]=m.useState(""),[i,c]=m.useState(null),[d,u]=m.useState(Gt),[f,l]=m.useState(!1),[j,x]=m.useState(!1),{isPending:k,mutateAsync:T}=z(_.icon.randomTheme.mutationOptions()),{isPending:w,mutateAsync:y}=z(_.workspace.project.questConfig.update.mutationOptions()),{data:p,isLoading:N,refetch:b}=H(_.workspace.project.questConfig.bySubdomain.queryOptions({input:{subdomain:a}}));m.useEffect(()=>{n&&b()},[n,b]),m.useEffect(()=>{n&&(p?.icon?.lucide&&u(p.icon.lucide),p?.icon?.background?c(p.icon.background):i||T({}).then(h=>{c(h.theme)}),p?.name&&o(p.name))},[p,n]);const P=async()=>{await y({description:p?.description,icon:{background:i??ls,lucide:d},name:r,subdomain:a}),s(!1)},A=is[d],D=k||w||N,M=async h=>{h.preventDefault(),!(!r.trim()||D)&&await P()};return e.jsx(Ee,{onOpenChange:s,open:n,children:e.jsxs(Re,{children:[e.jsx(Pe,{children:e.jsx(Fe,{children:t})}),e.jsxs("form",{onSubmit:M,children:[e.jsx("div",{className:"grid gap-4 pt-4 pb-8",children:e.jsxs("div",{className:"flex gap-6 items-center",children:[e.jsx("div",{className:"flex flex-col items-center gap-2 min-w-fit pt-2",children:e.jsx(Wt,{background:i??void 0,icon:d})}),e.jsxs("div",{className:"flex-1 grid gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(Ue,{htmlFor:"title",children:"Title"}),e.jsx(cn,{disabled:D,id:"title",onChange:h=>{o(h.target.value)},placeholder:"Enter project title...",value:r})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(Ue,{htmlFor:"icon",children:"Icon"}),e.jsxs(ds,{onOpenChange:x,open:j,children:[e.jsx(us,{asChild:!0,children:e.jsxs(I,{"aria-expanded":j,className:"justify-between flex-1",disabled:D,role:"combobox",type:"button",variant:"outline",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(A,{className:"h-4 w-4"})}),e.jsx(me,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ms,{className:"w-80 p-0",children:e.jsxs(sn,{children:[e.jsx("div",{className:"flex flex-1 items-center border-b",children:e.jsx(tn,{className:"flex-1 border-0 outline-none focus:ring-0",containerClassName:"border-0 flex-1",placeholder:"Search icons..."})}),e.jsxs(nn,{children:[e.jsx(an,{children:"No icons found."}),e.jsx(on,{children:e.jsx("div",{className:"grid grid-cols-6 gap-2 p-2",children:Jt.map(h=>{const E=is[h];return e.jsx(rn,{className:$("w-10 h-10 rounded-lg border-2 transition-all hover:scale-105 flex items-center justify-center cursor-pointer p-0",d===h?"border-foreground ring-2 ring-ring bg-accent":"border-muted hover:border-foreground"),onSelect:()=>{u(h),x(!1)},value:h,children:e.jsx(E,{className:"h-5 w-5"})},h)})})})]})]})})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(Ue,{htmlFor:"color",children:"Color"}),e.jsxs(ds,{onOpenChange:l,open:f,children:[e.jsx(us,{asChild:!0,children:e.jsxs(I,{"aria-expanded":f,className:"justify-between",disabled:D,role:"combobox",type:"button",variant:"outline",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"w-4 h-4 rounded-full",style:{background:i??ls}})}),e.jsx(me,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ms,{className:"p-3 w-fit",children:e.jsx("div",{className:"grid grid-cols-4 gap-2",children:Kt.map(h=>e.jsx("button",{className:$("w-8 h-8 rounded-lg border-2 transition-all hover:scale-105",i===h?"border-foreground ring-2 ring-ring":"border-muted hover:border-foreground"),onClick:()=>{c(h),l(!1)},style:{background:h},type:"button"},h))})})]})]})]})]})]})}),e.jsxs(Xe,{children:[e.jsx(I,{onClick:()=>{s(!1)},type:"button",variant:"outline",children:"Cancel"}),e.jsxs(I,{disabled:D||!r.trim(),type:"submit",children:[e.jsx(Bs,{className:"h-4 w-4"}),"Save"]})]})]})]})})}function Ia({compact:t=!1,project:s}){const{data:n}=H(_.favorites.live.listProjects.experimental_liveOptions()),a=n?.some(d=>d.subdomain===s.subdomain),{mutateAsync:r}=z(_.favorites.remove.mutationOptions()),{mutateAsync:o}=z(_.favorites.add.mutationOptions()),i=()=>{r({subdomain:s.subdomain})},c=async()=>{await o({subdomain:s.subdomain})};return e.jsxs(I,{className:$(t&&"size-7"),onClick:()=>{a?i():c()},size:"sm",variant:"ghost",children:[a?e.jsx(cs,{className:"h-4 w-4 fill-amber-500 text-amber-500"}):e.jsx(cs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:a?"Unfavorite Project":"Favorite Project"})]})}const tt=wt(["cmd","cursor","iterm","powershell","terminal","vscode"]),fs=jt([bt("show-in-folder"),tt]);Nt({available:kt(),id:tt,name:yt()});function es(t){return t.replace(/^(?:\.\/)?src\//,"")}var S=function(t,s,n){if(!s.has(t))throw new TypeError("attempted to set private field on non-instance");return s.set(t,n),n},g=function(t,s){if(!s.has(t))throw new TypeError("attempted to get private field on non-instance");return s.get(t)},re,de,G,pe,Ne,J,K,Q,X,Y,Z,ee,se,ue,ge,ie,Ce,le;const Ea=function(t){var s=131,n=137,a=0;t+="x";var r=Math.floor(9007199254740991/n);for(let o=0;o<t.length;o++)a>r&&(a=Math.floor(a/n)),a=a*s+t.charCodeAt(o);return a},v="0123456789abcdef".split(""),Ra=[-2147483648,8388608,32768,128],q=[24,16,8,0],ke=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],L=[];class Pa{constructor(s=!1,n=!1){re.set(this,void 0),de.set(this,void 0),G.set(this,void 0),pe.set(this,void 0),Ne.set(this,void 0),J.set(this,void 0),K.set(this,void 0),Q.set(this,void 0),X.set(this,void 0),Y.set(this,void 0),Z.set(this,void 0),ee.set(this,void 0),se.set(this,void 0),ue.set(this,void 0),ge.set(this,void 0),ie.set(this,void 0),Ce.set(this,0),le.set(this,void 0),this.init(s,n)}init(s,n){n?(L[0]=L[16]=L[1]=L[2]=L[3]=L[4]=L[5]=L[6]=L[7]=L[8]=L[9]=L[10]=L[11]=L[12]=L[13]=L[14]=L[15]=0,S(this,de,L)):S(this,de,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),s?(S(this,J,3238371032),S(this,K,914150663),S(this,Q,812702999),S(this,X,4144912697),S(this,Y,4290775857),S(this,Z,1750603025),S(this,ee,1694076839),S(this,se,3204075428)):(S(this,J,1779033703),S(this,K,3144134277),S(this,Q,1013904242),S(this,X,2773480762),S(this,Y,1359893119),S(this,Z,2600822924),S(this,ee,528734635),S(this,se,1541459225)),S(this,re,S(this,le,S(this,G,S(this,ge,0)))),S(this,pe,S(this,ue,!1)),S(this,Ne,!0),S(this,ie,s)}update(s){if(g(this,pe))return this;let n;s instanceof ArrayBuffer?n=new Uint8Array(s):n=s;let a=0;const r=n.length,o=g(this,de);for(;a<r;){let i;if(g(this,ue)&&(S(this,ue,!1),o[0]=g(this,re),o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0),typeof n!="string")for(i=g(this,le);a<r&&i<64;++a)o[i>>2]|=n[a]<<q[i++&3];else for(i=g(this,le);a<r&&i<64;++a){let c=n.charCodeAt(a);c<128?o[i>>2]|=c<<q[i++&3]:c<2048?(o[i>>2]|=(192|c>>6)<<q[i++&3],o[i>>2]|=(128|c&63)<<q[i++&3]):c<55296||c>=57344?(o[i>>2]|=(224|c>>12)<<q[i++&3],o[i>>2]|=(128|c>>6&63)<<q[i++&3],o[i>>2]|=(128|c&63)<<q[i++&3]):(c=65536+((c&1023)<<10|n.charCodeAt(++a)&1023),o[i>>2]|=(240|c>>18)<<q[i++&3],o[i>>2]|=(128|c>>12&63)<<q[i++&3],o[i>>2]|=(128|c>>6&63)<<q[i++&3],o[i>>2]|=(128|c&63)<<q[i++&3])}S(this,Ce,i),S(this,G,g(this,G)+(i-g(this,le))),i>=64?(S(this,re,o[16]),S(this,le,i-64),this.hash(),S(this,ue,!0)):S(this,le,i)}return g(this,G)>4294967295&&(S(this,ge,g(this,ge)+(g(this,G)/4294967296<<0)),S(this,G,g(this,G)%4294967296)),this}finalize(){if(g(this,pe))return;S(this,pe,!0);const s=g(this,de),n=g(this,Ce);s[16]=g(this,re),s[n>>2]|=Ra[n&3],S(this,re,s[16]),n>=56&&(g(this,ue)||this.hash(),s[0]=g(this,re),s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),s[14]=g(this,ge)<<3|g(this,G)>>>29,s[15]=g(this,G)<<3,this.hash()}hash(){let s=g(this,J),n=g(this,K),a=g(this,Q),r=g(this,X),o=g(this,Y),i=g(this,Z),c=g(this,ee),d=g(this,se);const u=g(this,de);let f,l,j,x,k,T,w,y,p,N;for(let b=16;b<64;++b)x=u[b-15],f=(x>>>7|x<<25)^(x>>>18|x<<14)^x>>>3,x=u[b-2],l=(x>>>17|x<<15)^(x>>>19|x<<13)^x>>>10,u[b]=u[b-16]+f+u[b-7]+l<<0;N=n&a;for(let b=0;b<64;b+=4)g(this,Ne)?(g(this,ie)?(w=300032,x=u[0]-1413257819,d=x-150054599<<0,r=x+24177077<<0):(w=704751109,x=u[0]-210244248,d=x-1521486534<<0,r=x+143694565<<0),S(this,Ne,!1)):(f=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),l=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7),w=s&n,j=w^s&a^N,T=o&i^~o&c,x=d+l+T+ke[b]+u[b],k=f+j,d=r+x<<0,r=x+k<<0),f=(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10),l=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),y=r&s,j=y^r&n^w,T=d&o^~d&i,x=c+l+T+ke[b+1]+u[b+1],k=f+j,c=a+x<<0,a=x+k<<0,f=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),l=(c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7),p=a&r,j=p^a&s^y,T=c&d^~c&o,x=i+l+T+ke[b+2]+u[b+2],k=f+j,i=n+x<<0,n=x+k<<0,f=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),l=(i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7),N=n&a,j=N^n&r^p,T=i&c^~i&d,x=o+l+T+ke[b+3]+u[b+3],k=f+j,o=s+x<<0,s=x+k<<0;S(this,J,g(this,J)+s<<0),S(this,K,g(this,K)+n<<0),S(this,Q,g(this,Q)+a<<0),S(this,X,g(this,X)+r<<0),S(this,Y,g(this,Y)+o<<0),S(this,Z,g(this,Z)+i<<0),S(this,ee,g(this,ee)+c<<0),S(this,se,g(this,se)+d<<0)}hex(){this.finalize();const s=g(this,J),n=g(this,K),a=g(this,Q),r=g(this,X),o=g(this,Y),i=g(this,Z),c=g(this,ee),d=g(this,se);let u=v[s>>28&15]+v[s>>24&15]+v[s>>20&15]+v[s>>16&15]+v[s>>12&15]+v[s>>8&15]+v[s>>4&15]+v[s&15]+v[n>>28&15]+v[n>>24&15]+v[n>>20&15]+v[n>>16&15]+v[n>>12&15]+v[n>>8&15]+v[n>>4&15]+v[n&15]+v[a>>28&15]+v[a>>24&15]+v[a>>20&15]+v[a>>16&15]+v[a>>12&15]+v[a>>8&15]+v[a>>4&15]+v[a&15]+v[r>>28&15]+v[r>>24&15]+v[r>>20&15]+v[r>>16&15]+v[r>>12&15]+v[r>>8&15]+v[r>>4&15]+v[r&15]+v[o>>28&15]+v[o>>24&15]+v[o>>20&15]+v[o>>16&15]+v[o>>12&15]+v[o>>8&15]+v[o>>4&15]+v[o&15]+v[i>>28&15]+v[i>>24&15]+v[i>>20&15]+v[i>>16&15]+v[i>>12&15]+v[i>>8&15]+v[i>>4&15]+v[i&15]+v[c>>28&15]+v[c>>24&15]+v[c>>20&15]+v[c>>16&15]+v[c>>12&15]+v[c>>8&15]+v[c>>4&15]+v[c&15];return g(this,ie)||(u+=v[d>>28&15]+v[d>>24&15]+v[d>>20&15]+v[d>>16&15]+v[d>>12&15]+v[d>>8&15]+v[d>>4&15]+v[d&15]),u}toString(){return this.hex()}digest(){this.finalize();const s=g(this,J),n=g(this,K),a=g(this,Q),r=g(this,X),o=g(this,Y),i=g(this,Z),c=g(this,ee),d=g(this,se),u=[s>>24&255,s>>16&255,s>>8&255,s&255,n>>24&255,n>>16&255,n>>8&255,n&255,a>>24&255,a>>16&255,a>>8&255,a&255,r>>24&255,r>>16&255,r>>8&255,r&255,o>>24&255,o>>16&255,o>>8&255,o&255,i>>24&255,i>>16&255,i>>8&255,i&255,c>>24&255,c>>16&255,c>>8&255,c&255];return g(this,ie)||u.push(d>>24&255,d>>16&255,d>>8&255,d&255),u}array(){return this.digest()}arrayBuffer(){this.finalize();const s=new ArrayBuffer(g(this,ie)?28:32),n=new DataView(s);return n.setUint32(0,g(this,J)),n.setUint32(4,g(this,K)),n.setUint32(8,g(this,Q)),n.setUint32(12,g(this,X)),n.setUint32(16,g(this,Y)),n.setUint32(20,g(this,Z)),n.setUint32(24,g(this,ee)),g(this,ie)||n.setUint32(28,g(this,se)),s}}re=new WeakMap,de=new WeakMap,G=new WeakMap,pe=new WeakMap,Ne=new WeakMap,J=new WeakMap,K=new WeakMap,Q=new WeakMap,X=new WeakMap,Y=new WeakMap,Z=new WeakMap,ee=new WeakMap,se=new WeakMap,ue=new WeakMap,ge=new WeakMap,ie=new WeakMap,Ce=new WeakMap,le=new WeakMap;function Fa(t){const s=new Pa;return s.update(t),parseInt(s.hex().substring(0,8),16)}const Oa=function(t){var s="#";return t.forEach(function(n){n<16&&(s+=0),s+=n.toString(16)}),s},$a=function(t,s,n){t/=360;var a=n<.5?n*(1+s):n+s-n*s,r=2*n-a;return[t+1/3,t,t-1/3].map(function(o){return o<0&&o++,o>1&&o--,o<1/6?o=r+(a-r)*6*o:o<.5?o=a:o<2/3?o=r+(a-r)*6*(2/3-o):o=r,Math.round(o*255)})};class ss{constructor(s={}){const[n,a]=[s.lightness,s.saturation].map(function(r){return r=r!==void 0?r:[.35,.5,.65],Array.isArray(r)?r.concat():[r]});this.L=n,this.S=a,typeof s.hue=="number"&&(s.hue={min:s.hue,max:s.hue}),typeof s.hue=="object"&&!Array.isArray(s.hue)&&(s.hue=[s.hue]),typeof s.hue>"u"&&(s.hue=[]),this.hueRanges=s.hue.map(function(r){return{min:typeof r.min>"u"?0:r.min,max:typeof r.max>"u"?360:r.max}}),this.hash=Fa,typeof s.hash=="function"&&(this.hash=s.hash),s.hash==="bkdr"&&(this.hash=Ea)}hsl(s){var n,a,r,o=this.hash(s),i=727;if(this.hueRanges.length){const c=this.hueRanges[o%this.hueRanges.length];n=o/this.hueRanges.length%i*(c.max-c.min)/i+c.min}else n=o%359;return o=Math.ceil(o/360),a=this.S[o%this.S.length],o=Math.ceil(o/this.S.length),r=this.L[o%this.L.length],[n,a,r]}rgb(s){var n=this.hsl(s);return $a.apply(this,n)}hex(s){var n=this.rgb(s);return Oa(n)}}function La({projectSubdomain:t,showFullMessage:s=!1,versionRef:n}){const{data:a}=H(_.workspace.project.git.ref.queryOptions({input:{gitRef:n,projectSubdomain:t}}));return a?.commitMessage?e.jsx("div",{className:`text-sm text-foreground font-medium text-wrap ${s?"":"line-clamp-2"}`,children:a.commitMessage}):e.jsx("span",{className:"text-sm text-muted-foreground italic",children:"No commit message"})}function za({maxFiles:t=3,projectSubdomain:s,versionRef:n}){const[a,r]=m.useState(!1),{data:o}=H(_.workspace.project.git.ref.queryOptions({input:{gitRef:n,projectSubdomain:s}}));if(!o||o.files.length===0)return null;const i=a?o.files:o.files.slice(0,t),c=o.files.length>t;return e.jsxs("div",{className:"w-full flex flex-col gap-1",children:[i.map(d=>e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground w-full",children:[e.jsx("span",{className:"truncate flex-1 font-mono",children:es(d.filename)}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[d.additions>0&&e.jsxs("span",{className:"text-muted-foreground",children:["+",d.additions]}),d.deletions>0&&e.jsxs("span",{className:"text-muted-foreground",children:["-",d.deletions]})]})]},d.filename)),c&&e.jsx("button",{className:"text-xs text-muted-foreground hover:text-foreground transition-colors text-left mt-1 cursor-pointer",onClick:d=>{d.preventDefault(),d.stopPropagation(),r(!a)},children:a?"Show less":`Show ${o.files.length-t} more file${o.files.length-t===1?"":"s"}`})]})}function Ua({isCurrentVersion:t=!1,versionRef:s}){const n=m.useMemo(()=>new ss().hex(s),[s]);return e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Vs,{className:"size-4.5 shrink-0 -ms-1 -me-1",style:{color:n}}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:"Version"}),t&&e.jsx(xe,{className:"text-xs py-0 px-2",variant:"outline",children:"Latest"})]})]})}function nt({className:t="",iconSize:s="sm",projectSubdomain:n,versionRef:a}){const r=m.useMemo(()=>new ss().hex(a),[a]),{data:o}=H(_.workspace.project.git.ref.queryOptions({input:{gitRef:a,projectSubdomain:n}})),i=s==="sm"?"h-4 w-4":"h-5 w-5";return e.jsxs("span",{className:`inline-flex items-center gap-2 ${t}`,children:[e.jsx(Vs,{className:`${i} shrink-0 -me-1`,style:{color:r}}),e.jsx("span",{className:"text-xs text-muted-foreground shrink-0",children:"Version"}),e.jsx("span",{className:"text-xs min-w-0 line-clamp-1",children:o?.commitMessage||"No commit message"})]})}function Va({projectSubdomain:t,restoredFromRef:s}){return e.jsx("div",{className:"pt-2 border-t border-border",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("span",{className:"text-xs text-muted-foreground shrink-0",children:["Restored from"," "]}),e.jsx(nt,{projectSubdomain:t,versionRef:s})]})})}function Ae({disableBorder:t=!1,disableLink:s=!1,isLastGitCommit:n=!1,isSelected:a=!1,projectSubdomain:r,restoredFromRef:o,showCommitMessage:i=!0,showFullCommitMessage:c=!1,versionRef:d}){const u=!a&&!n,f=!s,l=e.jsx("div",{className:$("text-card-foreground flex flex-col gap-6 rounded-lg border py-0 shadow-sm overflow-hidden bg-card","p-3 transition-colors relative",!s&&(a?"border-secondary-foreground hover:bg-muted/30":"hover:bg-muted/50"),s&&"border-border",t&&"border-0"),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Ua,{isCurrentVersion:n,versionRef:d}),f&&e.jsx("div",{className:"shrink-0",children:a?e.jsx("div",{className:"flex items-center gap-1.5 text-xs font-medium",children:"Viewing"}):e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground hover:text-foreground transition-colors group",children:[e.jsx("span",{className:"font-medium",children:"View"}),e.jsx(un,{className:"h-3 w-3 group-hover:translate-x-0.5 transition-transform"})]})})]}),i&&e.jsx(La,{projectSubdomain:r,showFullMessage:c,versionRef:d}),e.jsx(za,{projectSubdomain:r,versionRef:d}),o&&e.jsx(Va,{projectSubdomain:r,restoredFromRef:o})]})});return s?l:e.jsx(Ss,{from:"/projects/$subdomain",params:{subdomain:r},search:j=>({...j,selectedVersion:u?d:void 0}),children:l})}function at({isOpen:t,onClose:s,onRestore:n,projectSubdomain:a,versionRef:r}){const[o,i]=m.useState(!1),c=be(),{selectedSessionId:d}=_e({from:"/_app/projects/$subdomain/"}),u=async()=>{if(!d){O.error("Session required",{description:"A session must be selected to restore a version"});return}i(!0);try{const[l,j,x]=await St(Tt.workspace.project.version.restore({gitRef:r,projectSubdomain:a,sessionId:d}));if(l){if(x)switch(l.code){case"NO_CHANGES":{O.error("No changes to restore",{description:"Restoring to this version would not make any changes"});break}case"VERSION_NOT_FOUND":{O.error("Version not found",{description:"The version you are trying to restore is missing from Git"});break}default:O.error("Unable to restore version",{description:l.message})}else O.error("Unable to restore version",{description:l.message});return}n(),O.success("Version restored successfully",{description:e.jsx(nt,{projectSubdomain:a,versionRef:j.restoredToRef})}),await c({from:"/projects/$subdomain",params:{subdomain:a},search:k=>({...k,selectedVersion:void 0})}),s()}catch(l){O.error("Failed to restore version",{description:l instanceof Error?l.message:"Unknown error occurred"})}finally{i(!1)}},f=o||!d;return e.jsx(Ee,{onOpenChange:l=>{l||s()},open:t,children:e.jsxs(Re,{className:"sm:max-w-md",children:[e.jsxs(Pe,{children:[e.jsx(Fe,{children:"Restore Version"}),e.jsx(Ds,{children:"You are about to restore your project to this version:"})]}),e.jsx("div",{className:"my-4 max-h-[300px] overflow-y-auto",children:e.jsx(Ae,{disableLink:!0,isLastGitCommit:!1,isSelected:!1,projectSubdomain:a,showCommitMessage:!0,versionRef:r})}),!d&&e.jsx("div",{className:"p-3 bg-muted rounded-md",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"A session must be selected to restore a version. Select a session from the sidebar first."})}),e.jsxs(Xe,{className:"gap-2",children:[e.jsx(I,{disabled:o,onClick:s,variant:"outline",children:"Cancel"}),e.jsx(I,{disabled:f,onClick:u,variant:"destructive",children:o?e.jsxs(e.Fragment,{children:[e.jsx(hs,{className:"h-4 w-4 mr-2 animate-spin"}),"Restoring..."]}):e.jsxs(e.Fragment,{children:[e.jsx(hs,{className:"h-4 w-4 mr-1"}),"Restore Version"]})})]})]})})}const ps={cmd:pn,cursor:fn,iterm:xn,powershell:_s,terminal:hn,vscode:mn};function Ba({iframeRef:t,onDeleteClick:s,onSidebarToggle:n,project:a,selectedVersion:r,sidebarCollapsed:o}){const[i,c]=m.useState(!1),[d,u]=m.useState(!1),f=be(),l=z(_.utils.openExternalLink.mutationOptions()),j=z(_.utils.showFileInFolder.mutationOptions()),x=z(_.utils.openAppIn.mutationOptions({onError:A=>{O.error("Failed to open in app",{description:A.message})}})),k=z(_.utils.takeScreenshot.mutationOptions({onError:A=>{O.error("Failed to take screenshot",{description:A.message})},onSuccess:A=>{O.success("Screenshot saved to Downloads",{action:{label:ze()?"Reveal in Finder":"Show File",onClick:()=>{j.mutate({filepath:A.filepath})}},closeButton:!0,dismissible:!0})}})),T=z(_.utils.copyScreenshotToClipboard.mutationOptions({onError:A=>{O.error("Failed to copy screenshot",{description:A.message})},onSuccess:()=>{O.success("Screenshot copied to clipboard")}})),{data:w=[]}=H(_.utils.getSupportedEditors.queryOptions()),y=()=>{l.mutate({url:a.urls.localhost})},p=async()=>{if(!t.current){O.error("Unable to capture screenshot",{description:"Iframe not found"});return}await new Promise(h=>setTimeout(h,100));const D=t.current.getBoundingClientRect(),M={height:D.height,width:D.width,x:D.left,y:D.top};k.mutate({bounds:M,subdomain:a.subdomain})},N=async()=>{if(!t.current){O.error("Unable to capture screenshot",{description:"Iframe not found"});return}await new Promise(h=>setTimeout(h,100));const D=t.current.getBoundingClientRect(),M={height:D.height,width:D.width,x:D.left,y:D.top};T.mutate({bounds:M,subdomain:a.subdomain})},b=()=>{f({from:"/projects/$subdomain",params:{subdomain:a.subdomain},replace:!0,search:A=>({...A,selectedVersion:void 0})})},P=()=>{u(!0)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-background shadow-sm pl-3 pr-2 py-1 w-full",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:$("flex items-center gap-2",!o&&"w-96 shrink-0 justify-between pr-5"),children:[e.jsxs(qe,{children:[e.jsx(Ge,{asChild:!0,children:e.jsxs(I,{className:"font-semibold text-foreground h-auto hover:bg-accent hover:text-accent-foreground gap-2 py-1 has-[>svg]:px-1",variant:"ghost",children:[e.jsx(Qt,{background:a.icon?.background,icon:a.icon?.lucide,size:"md"}),a.title,e.jsx(me,{className:"h-3 w-3"})]})}),e.jsxs(We,{align:"end",side:"bottom",children:[e.jsxs(W,{onClick:()=>{c(!0)},children:[e.jsx(Nn,{className:"h-4 w-4"}),e.jsx("span",{children:"Settings"})]}),e.jsx(fe,{}),e.jsxs(Is,{children:[e.jsxs(Es,{children:[e.jsx(Wn,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Open In"})]}),e.jsxs(Rs,{children:[e.jsxs(W,{onClick:()=>{x.mutateAsync({subdomain:a.subdomain,type:"show-in-folder"})},children:[e.jsx(xs,{className:"h-4 w-4"}),ze()?"Reveal in Finder":"Show in file manager"]}),e.jsxs(W,{onClick:y,children:[e.jsx(Fs,{className:"h-4 w-4"}),"External browser"]}),(()=>{const A=w.filter(M=>M.available&&["cursor","vscode"].includes(M.id)),D=w.filter(M=>M.available&&["iterm","terminal"].includes(M.id));return e.jsxs(e.Fragment,{children:[A.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(fe,{}),A.map(M=>{const h=ps[M.id];return e.jsxs(W,{onClick:()=>{x.mutateAsync({subdomain:a.subdomain,type:fs.parse(M.id)})},children:[e.jsx(h,{className:"h-4 w-4"}),M.name]},M.id)})]}),D.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(fe,{}),D.map(M=>{const h=ps[M.id];return e.jsxs(W,{onClick:()=>{x.mutateAsync({subdomain:a.subdomain,type:fs.parse(M.id)})},children:[e.jsx(h,{className:"h-4 w-4"}),M.name]},M.id)})]})]})})()]})]}),e.jsx(fe,{}),e.jsxs(W,{className:"text-destructive focus:bg-destructive/15 focus:text-destructive",onSelect:s,children:[e.jsx(dn,{}),e.jsx("span",{children:"Delete"})]})]})]}),e.jsx(I,{className:"ml-1 transition-all duration-300 ease-in-out h-7 inline-flex items-center select-none",onClick:n,size:"sm",title:o?"Show sidebar":"Hide sidebar",variant:o?"secondary":"ghost",children:o?e.jsxs(e.Fragment,{children:[e.jsx(Xt,{className:"h-4 w-4"}),e.jsx("span",{children:"Chat"})]}):e.jsx(qn,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex items-center",children:r?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{onClick:b,size:"sm",variant:"secondary",children:"Exit"}),e.jsx(I,{onClick:P,size:"sm",children:"Restore this version"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ia,{project:a}),e.jsxs(qe,{children:[e.jsx(Ge,{asChild:!0,children:e.jsx(I,{className:"gap-1 h-7 select-none",size:"sm",variant:"secondary",children:"Share"})}),e.jsxs(We,{align:"end",children:[e.jsxs(W,{onClick:N,children:[e.jsx(Yt,{className:"h-4 w-4"}),"Copy screenshot"]}),e.jsxs(W,{onClick:p,children:[e.jsx(Bs,{className:"h-4 w-4"}),"Save screenshot"]}),e.jsx(fe,{}),e.jsxs(W,{onClick:()=>{x.mutateAsync({subdomain:a.subdomain,type:"show-in-folder"})},children:[e.jsx(xs,{className:"h-4 w-4"}),ze()?"Reveal in Finder":"Show in File Manager"]})]})]})]})})]})}),e.jsx(Da,{dialogTitle:"Project Settings",onOpenChange:c,open:i,subdomain:a.subdomain}),r&&e.jsx(at,{isOpen:d,onClose:()=>{u(!1)},onRestore:()=>{u(!1)},projectSubdomain:a.subdomain,versionRef:r})]})}function Ha({iframeRef:t,project:s,selectedVersion:n,subdomain:a}){const r=m.useMemo(()=>n?new ss().hex(n):void 0,[n]),{data:o}=H({..._.workspace.project.git.ref.queryOptions({input:{gitRef:n??"",projectSubdomain:a}}),enabled:!!n}),i=z(_.utils.openExternalLink.mutationOptions()),c=()=>{i.mutate({url:s.urls.localhost})},d=e.jsx(e.Fragment,{children:e.jsxs(Je,{children:[e.jsx(Ke,{asChild:!0,children:e.jsx(I,{className:"ml-1 size-6",onClick:c,size:"icon",variant:"ghost",children:e.jsx(Fs,{className:"h-4 w-4"})})}),e.jsx(Qe,{children:e.jsx("p",{children:"Open in external browser"})})]})}),u=null,f=n?e.jsx("div",{className:"flex-1 flex items-center justify-center min-w-0",children:e.jsx(yn,{children:e.jsxs(Je,{children:[e.jsx(Ke,{asChild:!0,children:e.jsx("div",{className:"text-xs file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive text-center items-center justify-center whitespace-nowrap overflow-hidden cursor-pointer",style:{backgroundColor:`${r??""}20`,borderColor:`${r??""}50`},children:e.jsxs("span",{className:"text-ellipsis min-w-0",children:["Viewing Version"," ",e.jsx("span",{className:"font-mono font-semibold",children:n.slice(0,8)}),o?.commitMessage&&e.jsxs(e.Fragment,{children:[":"," ",o.commitMessage.length>50?`${o.commitMessage.slice(0,50)}...`:o.commitMessage]})]})})}),e.jsx(Qe,{arrowClassName:"bg-background fill-background border-b border-r border-border",className:"min-w-xs max-w-md p-0 bg-background text-foreground border border-border",side:"bottom",children:e.jsx(Ae,{disableBorder:!0,disableLink:!0,isLastGitCommit:!1,isSelected:!1,projectSubdomain:a,showCommitMessage:!0,showFullCommitMessage:!0,versionRef:n})})]})})}):void 0;return e.jsx(Rt,{app:s,centerActions:d,centerContent:f,iframeRef:t,rightActions:u})}/*!---------------------------------------------------------------------------------------------
 *  Copyright (c) StackBlitz. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/const qa={damping:.7,stiffness:.05,mass:1.25},Ga=70,Wa=1e3/60,Ja=350;let $e=!1;globalThis.document?.addEventListener("mousedown",()=>{$e=!0});globalThis.document?.addEventListener("mouseup",()=>{$e=!1});globalThis.document?.addEventListener("click",()=>{$e=!1});const ot=(t={})=>{const[s,n]=m.useState(!1),[a,r]=m.useState(t.initial!==!1),[o,i]=m.useState(!1),c=m.useRef(null);c.current=t;const d=m.useCallback(()=>{if(!$e)return!1;const p=window.getSelection();if(!p||!p.rangeCount)return!1;const N=p.getRangeAt(0);return N.commonAncestorContainer.contains(w.current)||w.current?.contains(N.commonAncestorContainer)},[]),u=m.useCallback(p=>{l.isAtBottom=p,r(p)},[]),f=m.useCallback(p=>{l.escapedFromLock=p,n(p)},[]),l=m.useMemo(()=>{let p;return{escapedFromLock:s,isAtBottom:a,resizeDifference:0,accumulated:0,velocity:0,listeners:new Set,get scrollTop(){return w.current?.scrollTop??0},set scrollTop(N){w.current&&(w.current.scrollTop=N,l.ignoreScrollToTop=w.current.scrollTop)},get targetScrollTop(){return!w.current||!y.current?0:w.current.scrollHeight-1-w.current.clientHeight},get calculatedTargetScrollTop(){if(!w.current||!y.current)return 0;const{targetScrollTop:N}=this;if(!t.targetScrollTop)return N;if(p?.targetScrollTop===N)return p.calculatedScrollTop;const b=Math.max(Math.min(t.targetScrollTop(N,{scrollElement:w.current,contentElement:y.current}),N),0);return p={targetScrollTop:N,calculatedScrollTop:b},requestAnimationFrame(()=>{p=void 0}),b},get scrollDifference(){return this.calculatedTargetScrollTop-this.scrollTop},get isNearBottom(){return this.scrollDifference<=Ga}}},[]),j=m.useCallback((p={})=>{typeof p=="string"&&(p={animation:p}),p.preserveScrollPosition||u(!0);const N=Date.now()+(Number(p.wait)||0),b=Be(c.current,p.animation),{ignoreEscapes:P=!1}=p;let A,D=l.calculatedTargetScrollTop;p.duration instanceof Promise?p.duration.finally(()=>{A=Date.now()}):A=N+(p.duration??0);const M=async()=>{const h=new Promise(requestAnimationFrame).then(()=>{if(!l.isAtBottom)return l.animation=void 0,!1;const{scrollTop:E}=l,C=performance.now(),R=(C-(l.lastTick??C))/Wa;if(l.animation||(l.animation={behavior:b,promise:h,ignoreEscapes:P}),l.animation.behavior===b&&(l.lastTick=C),d()||N>Date.now())return M();if(E<Math.min(D,l.calculatedTargetScrollTop)){if(l.animation?.behavior===b){if(b==="instant")return l.scrollTop=l.calculatedTargetScrollTop,M();l.velocity=(b.damping*l.velocity+b.stiffness*l.scrollDifference)/b.mass,l.accumulated+=l.velocity*R,l.scrollTop+=l.accumulated,l.scrollTop!==E&&(l.accumulated=0)}return M()}return A>Date.now()?(D=l.calculatedTargetScrollTop,M()):(l.animation=void 0,l.scrollTop<l.calculatedTargetScrollTop?j({animation:Be(c.current,c.current.resize),ignoreEscapes:P,duration:Math.max(0,A-Date.now())||void 0}):l.isAtBottom)});return h.then(E=>(requestAnimationFrame(()=>{l.animation||(l.lastTick=void 0,l.velocity=0)}),E))};return p.wait!==!0&&(l.animation=void 0),l.animation?.behavior===b?l.animation.promise:M()},[u,d,l]),x=m.useCallback(()=>{f(!0),u(!1)},[f,u]),k=m.useCallback(({target:p})=>{if(p!==w.current)return;const{scrollTop:N,ignoreScrollToTop:b}=l;let{lastScrollTop:P=N}=l;l.lastScrollTop=N,l.ignoreScrollToTop=void 0,b&&b>N&&(P=b),i(l.isNearBottom),setTimeout(()=>{if(l.resizeDifference||N===b)return;if(d()){f(!0),u(!1);return}const A=N>P,D=N<P;if(l.animation?.ignoreEscapes){l.scrollTop=P;return}D&&(f(!0),u(!1)),A&&f(!1),!l.escapedFromLock&&l.isNearBottom&&u(!0)},1)},[f,u,d,l]),T=m.useCallback(({target:p,deltaY:N})=>{let b=p;for(;!["scroll","auto"].includes(getComputedStyle(b).overflow);){if(!b.parentElement)return;b=b.parentElement}b===w.current&&N<0&&w.current.scrollHeight>w.current.clientHeight&&!l.animation?.ignoreEscapes&&(f(!0),u(!1))},[f,u,l]),w=gs(p=>{w.current?.removeEventListener("scroll",k),w.current?.removeEventListener("wheel",T),p?.addEventListener("scroll",k,{passive:!0}),p?.addEventListener("wheel",T,{passive:!0})},[]),y=gs(p=>{if(l.resizeObserver?.disconnect(),!p)return;let N;l.resizeObserver=new ResizeObserver(([b])=>{const{height:P}=b.contentRect,A=P-(N??P);if(l.resizeDifference=A,l.scrollTop>l.targetScrollTop&&(l.scrollTop=l.targetScrollTop),i(l.isNearBottom),A>=0){const D=Be(c.current,N?c.current.resize:c.current.initial);j({animation:D,wait:!0,preserveScrollPosition:!0,duration:D==="instant"?void 0:Ja})}else l.isNearBottom&&(f(!1),u(!0));N=P,requestAnimationFrame(()=>{setTimeout(()=>{l.resizeDifference===A&&(l.resizeDifference=0)},1)})}),l.resizeObserver?.observe(p)},[]);return{contentRef:y,scrollRef:w,scrollToBottom:j,stopScroll:x,isAtBottom:a||o,isNearBottom:o,escapedFromLock:s,state:l}};function gs(t,s){const n=m.useCallback(a=>(n.current=a,t(a)),s);return n}const Ve=new Map;function Be(...t){const s={...qa};let n=!1;for(const r of t){if(r==="instant"){n=!0;continue}typeof r=="object"&&(n=!1,s.damping=r.damping??s.damping,s.stiffness=r.stiffness??s.stiffness,s.mass=r.mass??s.mass)}const a=JSON.stringify(s);return Ve.has(a)||Ve.set(a,Object.freeze(s)),n?"instant":Ve.get(a)}const Ka=t=>t<1024?`${t} bytes`:`${(t/1024).toFixed(1)} KB`;function Qa({data:t,downloadFilename:s="data",maxDisplaySize:n=5e4,onOpenChange:a,open:r,title:o="JSON Viewer"}){const i=m.useCallback(()=>{const l=JSON.stringify(t,null,2);navigator.clipboard.writeText(l);const j=new TextEncoder().encode(l).length,x=j<1024?`${j} bytes`:`${(j/1024).toFixed(1)} KB`;O.success(`JSON data copied to clipboard (${x})`)},[t]),c=m.useCallback(()=>{const l=JSON.stringify(t,null,2),j=new Blob([l],{type:"application/json"}),x=URL.createObjectURL(j),k=document.createElement("a");k.href=x,k.download=`${s}-${Date.now()}.json`,document.body.appendChild(k),k.click(),k.remove(),URL.revokeObjectURL(x)},[t,s]),{displayData:d,isTruncated:u,originalSize:f}=m.useMemo(()=>{const l=JSON.stringify(t,null,2),j=new TextEncoder().encode(l).length;if(j<=n)return{displayData:l,isTruncated:!1,originalSize:j};let x=l.slice(0,Math.floor(n*.8));const k=x.lastIndexOf(`
`),T=x.lastIndexOf(","),w=Math.max(x.lastIndexOf("}"),x.lastIndexOf("]")),y=Math.max(k,T,w);return y>x.length*.5&&(x=x.slice(0,y)),{displayData:x+`

... [truncated]`,isTruncated:!0,originalSize:j}},[t,n]);return e.jsx(Ee,{onOpenChange:a,open:r,children:e.jsxs(Re,{className:"max-w-[90vw] border-warning/30 bg-background",children:[e.jsx(Pe,{children:e.jsxs(Fe,{className:"flex items-center gap-2 text-warning-foreground",children:[e.jsx(Us,{className:"size-4 text-warning"}),o,u&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(showing partial data - ",Ka(f)," total)"]})]})}),e.jsxs("div",{className:"relative min-w-0",children:[e.jsxs("div",{className:"absolute right-4 top-2 z-20 flex gap-2 pointer-events-auto",children:[e.jsx(I,{onClick:i,size:"sm",title:"Copy to clipboard",variant:"ghost",children:e.jsx(Ze,{className:"size-4"})}),e.jsx(I,{onClick:c,size:"sm",title:"Download full JSON",variant:"ghost",children:e.jsx(Ct,{className:"size-4"})})]}),e.jsx("div",{className:"max-h-[600px] min-w-0 overflow-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap break-all rounded-md bg-muted p-4 text-xs text-foreground min-w-0",children:d})})]})]})})}function Xa({project:t}){const{data:s=[]}=H(_.workspace.session.live.list.experimental_liveOptions({input:{subdomain:t.subdomain}})),{selectedSessionId:n}=_e({from:"/_app/projects/$subdomain/"}),a=be(),[r,o]=m.useState(!1),[i,c]=m.useState(),[d,u]=m.useState(!1),[f,l]=m.useState(null),j=z(_.workspace.session.remove.mutationOptions()),{data:x}=H({..._.workspace.session.byIdWithMessagesAndParts.queryOptions({input:i?{sessionId:i,subdomain:t.subdomain}:Mt})}),k=()=>{n&&(c(n),o(!0))},T=()=>{i&&j.mutate({sessionId:i,subdomain:t.subdomain},{onError:()=>{O.error("Failed to delete chat")},onSuccess:()=>{if(o(!1),c(void 0),n===i){const y=s.filter(N=>N.id!==i),p=y.length>0?y.at(-1)?.id:void 0;a({params:{subdomain:t.subdomain},replace:!0,search:N=>({...N,selectedSessionId:p}),to:"/projects/$subdomain"})}O.success("Chat deleted successfully")}})},w=x?(()=>{const y=x,p=y.messages.length,N=y.messages.filter(P=>P.role==="user").length;return{assistantMessages:y.messages.filter(P=>P.role==="assistant").length,createdAt:y.createdAt,messageCount:p,title:y.title||"Untitled Chat",userMessages:N}})():null;return e.jsxs(e.Fragment,{children:[e.jsxs(qe,{children:[e.jsx(Ge,{asChild:!0,children:e.jsx(I,{size:"sm",variant:"ghost",children:e.jsx(In,{className:"h-4 w-4"})})}),e.jsxs(We,{align:"end",children:[e.jsxs(Is,{children:[e.jsx(Es,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bn,{className:"h-4 w-4"}),"History"]})}),e.jsx(Rs,{children:s.length>0?e.jsx(gn,{onValueChange:y=>{const p=ce.SessionSchema.parse(y);a({params:{subdomain:t.subdomain},replace:!0,search:N=>({...N,selectedSessionId:p}),to:"/projects/$subdomain"})},value:n,children:s.map(y=>e.jsx(vn,{value:y.id,children:y.title||"Untitled Chat"},y.id))}):e.jsx(W,{disabled:!0,children:"No chats found"})})]}),e.jsx(fe,{}),!1,e.jsxs(W,{disabled:!n||j.isPending,onClick:k,variant:"destructive",children:[e.jsx(Yn,{className:"h-4 w-4"}),"Delete Chat"]})]})]}),e.jsx(Ee,{onOpenChange:o,open:r,children:e.jsxs(Re,{className:"sm:max-w-md",children:[e.jsxs(Pe,{children:[e.jsx(Fe,{children:"Delete chat"}),e.jsx(Ds,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"Are you sure you want to delete this chat? This action cannot be undone."}),w&&e.jsxs("div",{className:"mt-3 p-3 bg-muted rounded-md text-sm",children:[e.jsxs("div",{className:"font-medium mb-2",children:["“",w.title,"”"]}),e.jsxs("div",{className:"space-y-1 text-muted-foreground",children:[e.jsxs("div",{children:[w.messageCount," total message",w.messageCount===1?"":"s"]}),e.jsxs("div",{children:[w.userMessages," user message",w.userMessages===1?"":"s"," • ",w.assistantMessages," ","assistant message",w.assistantMessages===1?"":"s"]}),e.jsxs("div",{children:["Created"," ",w.createdAt.toLocaleDateString()]})]})]})]})})]}),e.jsxs(Xe,{className:"gap-2",children:[e.jsx(I,{disabled:j.isPending,onClick:()=>{o(!1),c(void 0)},variant:"outline",children:"Cancel"}),e.jsx(I,{disabled:j.isPending,onClick:T,variant:"destructive",children:j.isPending?"Deleting...":"Delete Chat"})]})]})}),e.jsx(Qa,{data:f,downloadFilename:"chat",onOpenChange:u,open:d,title:"Chat Data"})]})}const Ya=m.memo(function({part:s}){return e.jsx("div",{className:"text-sm leading-relaxed prose prose-sm max-w-none dark:prose-invert break-words overflow-wrap-anywhere",children:e.jsx(De,{markdown:s.text})})});function vs({message:t,onStartNewChat:s}){return e.jsxs($s,{className:"mt-4",variant:"warning",children:[e.jsx(ye,{}),e.jsxs(Ls,{className:"flex flex-col gap-3",children:[t&&e.jsx("div",{className:"text-xs",children:t}),e.jsx("div",{className:"text-xs",children:"If the error persists, try starting a new chat. Your app will not be affected."}),e.jsx(I,{onClick:s,size:"sm",variant:"outline",children:"Start new chat"})]})]})}function Me({children:t,data:s,label:n}){const[a,r]=m.useState(!1);return m.useCallback(o=>{o.stopPropagation(),r(!0)},[]),m.useCallback(()=>{r(!1)},[]),e.jsx(e.Fragment,{children:t})}const rt=m.memo(function({message:s,part:n}){const{realRole:a}=s.metadata,r=a==="system"?"System":a==="user"?"User":"Assistant";return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"text-xs text-foreground/70 font-medium mb-1",children:[r," prompt"]}),e.jsx("div",{className:"text-sm leading-relaxed prose prose-sm max-w-none dark:prose-invert break-words overflow-wrap-anywhere",children:e.jsx(De,{markdown:n.text})})]})}),Za=m.memo(function({messages:s}){const[n,a]=m.useState(!1),[r,o]=m.useState(!1),i=m.useMemo(()=>{const d=[];for(const u of s)for(const[f,l]of u.parts.entries())if(l.type==="text"){if(l.state==="done"&&l.text.trim()==="")continue;const j=e.jsx(rt,{message:u,part:l},l.metadata.id);d.push(e.jsx(Me,{data:l,label:l.type,children:j},l.metadata.id))}return d},[s]),c=async()=>{if(!r){o(!0);try{const d=s.flatMap(u=>u.parts).filter(u=>u.type==="text").map(u=>u.text).join(`

`);await navigator.clipboard.writeText(d),O.success("System prompt copied to clipboard")}catch{O.error("Failed to copy system prompt")}finally{o(!1)}}};return e.jsxs("div",{className:"w-full mb-2",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(I,{className:"h-5 px-2 text-xs text-muted-foreground/50 hover:text-muted-foreground hover:bg-accent/20 rounded-sm",onClick:()=>{a(!n)},variant:"ghost",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-[10px] font-normal",children:"View system prompt"}),n&&e.jsx(me,{className:"size-2"})]})})}),n&&e.jsxs("div",{className:"group mt-2",children:[e.jsxs("div",{className:"border-l-4 border-muted-foreground/30 pl-4 bg-muted/30 py-2 rounded-r-md",children:[e.jsx("div",{className:"mb-3 pb-2 pr-4 border-b border-muted-foreground/20",children:e.jsx("p",{className:"text-xs italic text-muted-foreground",children:"Instructions given to the agent explaining how to work in Quests."})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:e.jsx("div",{className:"flex flex-col gap-2",children:i})})]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsx("button",{"aria-label":"Copy system prompt",className:"p-1 text-muted-foreground hover:text-foreground hover:bg-muted/50 rounded transition-colors disabled:opacity-50 opacity-0 group-hover:opacity-100",disabled:r,onClick:c,children:e.jsx(Ze,{size:12})})})]})]})});function eo({defaultExpanded:t=!1,error:s}){const[n,a]=m.useState(t);m.useEffect(()=>{a(t)},[t]);const r=()=>{a(!n)},o=()=>{switch(s.kind){case"aborted":return"Aborted";case"api-call":case"api-key":case"invalid-tool-input":case"no-such-tool":return"Model Error";default:return"Error"}},i=()=>{switch(s.kind){case"aborted":return"Aborted";case"api-call":return"API Call Error";case"api-key":return"API Key Error";case"invalid-tool-input":return"Invalid Tool Input";case"no-such-tool":return"Tool Not Found";case"unknown":return"Unknown Error";default:return"Error"}},c=e.jsxs("div",{className:"flex items-center gap-2 min-w-0 w-full text-xs leading-tight",children:[e.jsx("span",{className:"shrink-0 text-warning-foreground/80",children:e.jsx(ye,{className:"size-3"})}),e.jsx("span",{className:"text-warning-foreground/80 font-medium shrink-0",children:o()}),e.jsx("span",{className:"ml-auto text-warning-foreground/60 truncate text-right min-w-0",children:i()}),n&&e.jsx("span",{className:"shrink-0 text-accent-foreground/60 ml-2",children:e.jsx(Oe,{className:"size-3"})})]});return e.jsxs("div",{className:"w-full",children:[e.jsx(I,{className:"h-auto p-0 w-full justify-start hover:bg-accent/30 rounded-sm",onClick:r,variant:"ghost",children:c}),n&&e.jsx("div",{className:"mt-2 text-xs",children:e.jsxs("div",{className:"p-2 bg-muted/30 rounded-md border max-h-64 overflow-y-auto",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"mb-1 font-semibold",children:"Error:"}),e.jsx("pre",{className:"whitespace-pre-wrap break-words font-mono text-xs",children:s.message})]}),s.kind==="api-call"&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"API:"})," ",s.name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"URL:"})," ",s.url]}),s.statusCode&&e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"})," ",s.statusCode]}),s.responseBody&&e.jsxs("div",{children:[e.jsx("strong",{children:"Response:"}),e.jsx("pre",{className:"mt-1 p-2 bg-muted rounded text-xs max-h-32 overflow-y-auto whitespace-pre-wrap break-words",children:s.responseBody})]})]}),s.kind==="invalid-tool-input"&&e.jsxs("div",{children:[e.jsx("div",{className:"mb-1 font-semibold",children:"Input:"}),e.jsx("pre",{className:"p-2 bg-muted rounded text-xs max-h-32 overflow-y-auto whitespace-pre-wrap break-words font-mono border",children:s.input})]}),s.kind==="no-such-tool"&&e.jsxs("div",{children:[e.jsx("strong",{children:"Tool:"})," ",s.toolName]})]})})]})}function js(t){const s=Math.round(t/1e3);if(s<1)return`${Math.round(t)}ms`;if(s<60)return`${s}s`;const n=Math.floor(s/60),a=s%60;return a===0?`${n}m`:`${n}m ${a}s`}function so(t,s){if(!t||!s)return"";const n=s.getTime()-t.getTime(),a=Math.round(n/1e3);return a<1?"1s":`${a}s`}const it=m.memo(function({createdAt:s,endedAt:n,isAgentRunning:a,isStreaming:r=!1,text:o}){const[i,c]=m.useState(!1),[d,u]=m.useState({canScrollDown:!1,canScrollUp:!1}),f=m.useRef(null),l=r&&a,j=so(s,n),{contentRef:x,scrollRef:k}=ot({damping:.9,mass:2.5,stiffness:.01}),T=()=>{const y=f.current;if(!y)return;const{clientHeight:p,scrollHeight:N,scrollTop:b}=y;u({canScrollDown:b<N-p-1,canScrollUp:b>0})};m.useEffect(()=>{const y=f.current;if(!y)return;T(),y.addEventListener("scroll",T);const p=new ResizeObserver(T);return p.observe(y),()=>{y.removeEventListener("scroll",T),p.disconnect()}},[i,l,o]);const w=e.jsxs("div",{className:"flex items-center gap-2 min-w-0 w-full text-xs leading-tight",children:[e.jsx("span",{className:"shrink-0 text-accent-foreground/80",children:e.jsx(zs,{className:"size-3"})}),e.jsx("span",{className:$("text-foreground/60 font-medium shrink-0",l&&"shiny-text"),children:l?"Planning...":j?`Thought for ${j}`:"Planning interrupted"}),!l&&i&&e.jsx("span",{className:"shrink-0 text-accent-foreground/60 ml-auto",children:e.jsx(me,{className:"size-3"})})]});return e.jsxs("div",{className:"w-full",children:[e.jsx(I,{className:"h-6 p-0 w-full justify-start hover:bg-accent/30 rounded-sm",onClick:()=>{c(!i)},variant:"ghost",children:w}),(l||i)&&!(l&&!o.trim())&&e.jsxs("div",{className:"mt-2 text-xs relative",children:[e.jsx("div",{className:"max-h-44 overflow-y-auto border-l-4 border-muted-foreground/30 pl-4 bg-muted/30 py-2 rounded-r-md",ref:y=>{f.current=y,l&&(k.current=y)},children:e.jsx("div",{className:$("text-sm leading-relaxed prose prose-sm max-w-none dark:prose-invert break-words overflow-wrap-anywhere italic",!l&&"opacity-60"),ref:x,children:e.jsx(De,{markdown:l||o.trim()?o:"Reasoning not available"})})}),d.canScrollUp&&e.jsx("div",{className:"absolute top-0 left-0 right-0 h-4 bg-gradient-to-b from-background to-transparent pointer-events-none z-10"}),d.canScrollDown&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-4 bg-gradient-to-t from-background to-transparent pointer-events-none z-10"})]})]})}),to={choose:"Answered",edit_file:"Edited",file_tree:"Listed files",glob:"Searched files",grep:"Searched text",read_file:"Read",run_diagnostics:"Ran diagnostics",run_git_commands:"Ran git commands",run_shell_command:"Ran command",think:"Thought",unavailable:"Unknown tool",write_file:"Wrote"},no={choose:"Answering",edit_file:"Editing a file",file_tree:"Listing files",glob:"Searching files",grep:"Searching text",read_file:"Reading",run_diagnostics:"Running diagnostics",run_git_commands:"Running git commands",run_shell_command:"Running command",think:"Thinking",unavailable:"Unknown tool",write_file:"Writing a file"},ao={choose:Ye,edit_file:en,file_tree:$n,glob:Zt,grep:kn,read_file:Us,run_diagnostics:Qn,run_git_commands:zn,run_shell_command:_s,think:zs,unavailable:ye,write_file:Pn};function bs(t){return to[t]??"Unknown tool"}function oo(t){return ao[t]??Ye}function ro(t){return no[t]??"Processing"}function io({part:t}){const n=(typeof t.input=="object"?t.input:void 0)?.explanation;return e.jsxs("div",{children:[n&&e.jsxs("div",{className:"mb-3 pb-2 border-b border-muted-foreground/20",children:[e.jsx(F,{children:"Explanation:"}),e.jsx("div",{className:"text-sm italic text-muted-foreground",children:n})]}),e.jsx(lo,{part:t})]})}function ve({children:t,className:s="text-xs whitespace-pre-wrap"}){return e.jsx("pre",{className:`font-mono ${s}`,children:t})}function He({filePath:t,label:s}){return e.jsxs("div",{children:[e.jsx(F,{children:s}),e.jsx(B,{children:es(t)})]})}function B({children:t,className:s=""}){return e.jsx("div",{className:`font-mono ${s}`,children:t})}function we({children:t}){return e.jsx(ve,{className:"text-xs whitespace-pre-wrap max-h-32 overflow-y-auto bg-background/50 p-2 rounded border",children:t})}function F({children:t}){return e.jsx("div",{className:"text-muted-foreground mb-1",children:t})}function lo({part:t}){switch(t.type){case"tool-choose":return e.jsxs("div",{children:[e.jsx(F,{children:"Question:"}),e.jsx("div",{className:"text-sm mb-2",children:t.input.question}),e.jsx(F,{children:"Choices:"}),e.jsx("div",{className:"space-y-1 mb-2",children:t.input.choices.map((s,n)=>e.jsx(B,{className:"text-xs",children:s},n))}),e.jsx(F,{children:"Selected choice:"}),e.jsx(B,{className:"font-semibold",children:t.output.selectedChoice})]});case"tool-edit_file":return e.jsxs("div",{children:[e.jsx(He,{filePath:t.output.filePath,label:"File edited:"}),t.input.oldString&&e.jsxs("div",{className:"mt-2",children:[e.jsx(F,{children:"Search pattern:"}),e.jsx(we,{children:t.input.oldString})]}),t.input.newString&&e.jsxs("div",{className:"mt-2",children:[e.jsx(F,{children:"Replacement:"}),e.jsx(we,{children:t.input.newString})]}),t.input.replaceAll&&e.jsx("div",{className:"mt-1",children:e.jsx(xe,{variant:"secondary",children:"Replace All"})})]});case"tool-file_tree":return e.jsxs("div",{children:[e.jsx(F,{children:"Directory structure:"}),e.jsx(ve,{children:t.output.tree})]});case"tool-glob":{const s=t.output.files;return e.jsxs("div",{children:[e.jsxs(F,{children:["Pattern:"," ",e.jsx(B,{className:"inline",children:t.input.pattern})]}),e.jsxs(F,{children:["Found ",s.length," files:"]}),s.length>0?e.jsx("div",{className:"space-y-1",children:s.map((n,a)=>e.jsx(B,{className:"text-xs",children:n},a))}):e.jsx("div",{className:"text-muted-foreground",children:"No files found"})]})}case"tool-grep":{const s=t.output.matches;return e.jsxs("div",{children:[e.jsxs(F,{children:["Pattern:"," ",e.jsx(B,{className:"inline",children:t.input.pattern})]}),t.input.path&&e.jsxs(F,{children:["Path: ",e.jsx(B,{className:"inline",children:t.input.path})]}),t.input.include&&e.jsxs(F,{children:["Include:"," ",e.jsx(B,{className:"inline",children:t.input.include})]}),e.jsxs(F,{children:["Found ",t.output.totalMatches," matches",t.output.truncated&&" (truncated)",":"]}),s.length>0?e.jsxs("div",{className:"space-y-2",children:[s.slice(0,10).map((n,a)=>e.jsxs("div",{className:"border-l-2 border-accent/30 pl-2",children:[e.jsxs(B,{className:"text-xs text-muted-foreground",children:[n.path,":",n.lineNum]}),e.jsx(B,{className:"text-xs",children:n.lineText})]},a)),s.length>10&&e.jsxs("div",{className:"text-muted-foreground text-xs",children:["... and ",s.length-10," more matches"]})]}):e.jsx("div",{className:"text-muted-foreground",children:"No matches found"})]})}case"tool-read_file":return t.output.state==="exists"?e.jsxs("div",{children:[e.jsxs(F,{children:["File: ",es(t.output.filePath)]}),t.input.offset!==void 0&&t.input.offset>0&&e.jsxs("div",{className:"text-muted-foreground text-xs mb-1",children:["Starting from line ",t.input.offset+1]}),t.input.limit!==void 0&&e.jsxs("div",{className:"text-muted-foreground text-xs mb-1",children:["Reading ",t.input.limit," lines"]}),t.output.content&&e.jsx(we,{children:t.output.content}),e.jsxs("div",{className:"text-muted-foreground text-xs mt-1",children:["Showing ",t.output.displayedLines," lines",t.output.hasMoreLines&&" (truncated)",t.output.offset>0&&` (offset: ${t.output.offset})`]})]}):e.jsxs("div",{children:[e.jsx(He,{filePath:t.output.filePath,label:"File not found:"}),t.output.suggestions.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx(F,{children:"Suggestions:"}),e.jsx("div",{className:"space-y-1",children:t.output.suggestions.map((s,n)=>e.jsx(B,{className:"text-xs text-muted-foreground",children:s},n))})]})]});case"tool-run_diagnostics":{const s=t.output.errors;return e.jsxs("div",{children:[e.jsxs(F,{children:["Diagnostics Results:"," ",s.length>0?`${s.length} error${s.length===1?"":"s"} found`:"No errors found"]}),s.length>0?e.jsx("div",{className:"space-y-1",children:s.map((n,a)=>e.jsx("div",{className:"border-l-2 border-red-300 dark:border-red-600 pl-2 text-xs font-mono",children:n},a))}):e.jsx("div",{className:"text-muted-foreground text-sm",children:"No diagnostic errors found in the project."})]})}case"tool-run_git_commands":{const s=t.output.results;return e.jsxs("div",{children:[e.jsx(F,{children:"Git commands executed:"}),e.jsx("div",{className:"space-y-2",children:s.map((n,a)=>e.jsxs("div",{className:"border-l-2 border-accent/30 pl-2",children:[e.jsxs(B,{className:"text-xs text-muted-foreground",children:["$ git ",n.command]}),e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsxs(xe,{variant:n.exitCode===0?"secondary":"destructive",children:["Exit code: ",n.exitCode]})}),n.stdout&&e.jsx(ve,{className:"text-xs text-green-600 dark:text-green-400 whitespace-pre-wrap",children:n.stdout}),n.stderr&&e.jsx(ve,{className:"text-xs text-red-600 dark:text-red-400 whitespace-pre-wrap",children:n.stderr})]},a))})]})}case"tool-run_shell_command":return e.jsxs("div",{children:[e.jsx(F,{children:"Command executed:"}),e.jsxs(B,{className:"text-xs mb-2",children:["$ ",t.output.command]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(xe,{variant:t.output.exitCode===0?"secondary":"destructive",children:["Exit code: ",t.output.exitCode]}),t.input.timeoutMs&&e.jsxs(xe,{variant:"outline",children:["Timeout: ",t.input.timeoutMs,"ms"]})]}),t.output.stdout&&e.jsxs(e.Fragment,{children:[e.jsx(F,{children:"Output:"}),e.jsx(we,{children:t.output.stdout})]}),t.output.stderr&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-1 text-red-600 dark:text-red-400",children:"Error:"}),e.jsx(ve,{className:"text-xs whitespace-pre-wrap bg-red-50 dark:bg-red-900/20 p-2 rounded border max-h-32 overflow-y-auto text-red-600 dark:text-red-400",children:t.output.stderr})]})]});case"tool-think":return e.jsxs("div",{children:[e.jsx(F,{children:"Thought:"}),e.jsx("div",{className:"text-sm italic",children:t.output.thought})]});case"tool-unavailable":return e.jsx("div",{children:e.jsx(F,{children:"Unknown tool"})});case"tool-write_file":return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(He,{filePath:t.output.filePath,label:"File written:"}),t.output.isNewFile&&e.jsx(xe,{variant:"secondary",children:"New file"})]}),e.jsx(F,{children:"Content preview:"}),e.jsx(we,{children:t.output.content.length>500?t.output.content.slice(0,500)+`
... (truncated)`:t.output.content}),e.jsxs("div",{className:"text-muted-foreground text-xs mt-1",children:[t.output.content.split(`
`).length," lines,"," ",t.output.content.length," characters"]})]});default:{const s=t;return e.jsxs("div",{children:[e.jsx(F,{children:"Tool completed"}),e.jsx(ve,{children:JSON.stringify(s,null,2)})]})}}}function co({isAgentRunning:t,part:s}){const[n,a]=m.useState(!1),r=ea(s.type),o=oo(r),i=(s.state==="input-streaming"||s.state==="input-available")&&t,c=s.state==="output-error",d=s.state==="output-available",u=d||c;let f,l;if(i?(f=ro(r),l=""):c?(f="Error",l=s.errorText):d&&s.type!=="tool-think"?(f=bs(r),l=uo(s)):f=bs(r),r==="think"){const T=s.state==="output-available"&&s.type==="tool-think"&&s.output.thought||"",w=s.state==="input-streaming"||s.state==="input-available";return e.jsx(it,{createdAt:s.metadata.createdAt,endedAt:s.state==="output-available"||s.state==="output-error"?s.metadata.endedAt:void 0,isAgentRunning:t,isStreaming:w,text:T})}const j=c?ye:o,x=()=>{u&&a(!n)},k=e.jsxs("div",{className:"flex items-center gap-2 min-w-0 w-full text-xs leading-tight",children:[i?e.jsx("span",{className:"shrink-0 text-accent-foreground/80",children:e.jsx("div",{className:"size-3 border border-current border-t-transparent rounded-full animate-spin"})}):e.jsx("span",{className:$("shrink-0 text-accent-foreground/80",c&&"text-warning-foreground/80"),children:e.jsx(j,{className:"size-3"})}),e.jsx("span",{className:$("text-foreground/60 font-medium shrink-0",c&&"text-warning-foreground/80",i&&"shiny-text"),children:f}),l&&e.jsx("span",{className:$("text-muted-foreground/60 truncate min-w-0",c&&"text-warning-foreground/60",i&&"shiny-text"),children:l}),u&&n&&e.jsx("span",{className:"shrink-0 text-accent-foreground/60 ml-auto",children:e.jsx(Oe,{className:"size-3"})})]});return e.jsxs("div",{className:"w-full",children:[u?e.jsx(I,{className:"h-6 p-0 w-full justify-start hover:bg-accent/30 rounded-sm",onClick:x,variant:"ghost",children:k}):e.jsx("div",{className:"h-6 flex items-center",children:k}),n&&d&&e.jsx("div",{className:"mt-2 text-xs",children:e.jsx("div",{className:"p-2 bg-muted/30 rounded-md border max-h-64 overflow-y-auto",children:e.jsx(io,{part:s})})}),n&&c&&e.jsxs("div",{className:"mt-2 text-xs space-y-2",children:[e.jsxs("div",{className:"p-2 bg-muted/30 rounded-md border max-h-64 overflow-y-auto",children:[e.jsx("div",{className:"mb-1 font-semibold",children:"Error:"}),e.jsx("pre",{className:"whitespace-pre-wrap break-words font-mono text-xs",children:s.errorText})]}),e.jsxs("div",{className:"p-2 bg-muted/30 rounded-md border max-h-64 overflow-y-auto",children:[e.jsx("div",{className:"mb-1 font-semibold",children:"Input:"}),e.jsx("pre",{className:"whitespace-pre-wrap break-words font-mono text-xs",children:JSON.stringify(s.rawInput,null,2)})]})]})]})}function Se(t){return t.replace(/^(?:\.\/)?src\//,"")}function uo(t){switch(t.type){case"tool-choose":return t.output.selectedChoice||"answered";case"tool-edit_file":return t.output.filePath?Se(t.output.filePath):"file edited";case"tool-file_tree":return t.output.tree?mo(t.output.tree,50):"files listed";case"tool-glob":{const s=t.output.files;return s.length===0?"No files found":`${s.length} files found`}case"tool-grep":{const s=t.output.matches;return s.length===0?"No matches found":`${s.length} matches found`}case"tool-read_file":return t.output.state==="exists"?t.output.filePath?Se(t.output.filePath):"file read":t.output.filePath?`${Se(t.output.filePath)}: not found`:"file not found";case"tool-run_diagnostics":{const s=t.output.errors.length;return s>0?`${s} error${s===1?"":"s"} found`:"no errors found"}case"tool-run_git_commands":return t.output.results.map(n=>n.command).join(", ")||"git commands executed";case"tool-run_shell_command":return t.output.command||"command executed";case"tool-unavailable":return"";case"tool-write_file":return t.output.filePath?Se(t.output.filePath):"file written";default:return console.warn("Unknown tool",t),"completed"}}function mo(t,s=100){return t.length<=s?t:t.slice(0,s)+"..."}function ho({part:t}){const[s,n]=m.useState(!1),a=()=>{n(!s)},r=e.jsxs("div",{className:"flex items-center gap-2 min-w-0 w-full text-xs leading-tight",children:[e.jsx("span",{className:"shrink-0 text-accent-foreground/80",children:e.jsx(Ye,{className:"size-3"})}),e.jsx("span",{className:"text-foreground/60 font-medium shrink-0",children:"Unknown part"}),e.jsx("span",{className:"text-muted-foreground/60 truncate min-w-0",children:t.type}),s&&e.jsx("span",{className:"shrink-0 text-accent-foreground/60 ml-auto",children:e.jsx(Oe,{className:"size-3"})})]});return e.jsxs("div",{className:"w-full",children:[e.jsx(I,{className:"h-auto p-0 w-full justify-start hover:bg-accent/30 rounded-sm",onClick:a,variant:"ghost",children:r}),s&&e.jsx("div",{className:"mt-2 text-xs",children:e.jsxs("div",{className:"p-2 bg-muted/30 rounded-md border max-h-64 overflow-y-auto",children:[e.jsx("div",{className:"mb-1 font-semibold",children:"Unknown Part Data:"}),e.jsx("pre",{className:"whitespace-pre-wrap break-words font-mono text-xs",children:JSON.stringify(t,null,2)})]})})]})}function he(t){return t>=1e6?`${(t/1e6).toFixed(1).replace(/\.0$/,"")}M`:t>=1e3?`${(t/1e3).toFixed(1).replace(/\.0$/,"")}K`:t.toString()}function ws({messages:t}){const[s,n]=m.useState(!1),a=m.useMemo(()=>{const i=new Map;for(const c of t)if(c.role==="assistant"&&c.metadata.modelId&&!c.metadata.synthetic){const d=c.metadata.modelId,u=c.metadata.providerId;i.set(d,{label:d,providerId:u})}return[...i.entries()].sort(([c],[d])=>c.localeCompare(d)).map(([c,d])=>({id:c,label:d.label,provider:d.providerId}))},[t]),r=m.useMemo(()=>{const i={cachedInputTokens:0,inputTokens:0,outputTokens:0,reasoningTokens:0,totalTokens:0};for(const c of t)if(c.role==="assistant"&&c.metadata.usage){const d=c.metadata.usage;Number.isNaN(d.inputTokens)||(i.inputTokens+=d.inputTokens||0),Number.isNaN(d.outputTokens)||(i.outputTokens+=d.outputTokens||0),Number.isNaN(d.totalTokens)||(i.totalTokens+=d.totalTokens||0),Number.isNaN(d.reasoningTokens)||(i.reasoningTokens+=d.reasoningTokens||0),Number.isNaN(d.cachedInputTokens)||(i.cachedInputTokens+=d.cachedInputTokens||0)}return i},[t]),o=m.useMemo(()=>{let i=0,c=0,d=0,u=0,f=0;for(const k of t)if(k.role==="assistant"&&(k.metadata.msToFinish&&(i+=k.metadata.msToFinish,f++),k.metadata.msToFirstChunk&&(c+=k.metadata.msToFirstChunk),k.metadata.completionTokensPerSecond&&k.metadata.msToFinish)){const T=k.metadata.usage?.outputTokens||0;T>0&&(d+=T,u+=k.metadata.msToFinish)}const l=f>0?i/f:0,j=f>0?c/f:0,x=u>0?d/u*1e3:0;return{avgMsToFinish:l,avgMsToFirstChunk:j,avgTokensPerSecond:x,requestCount:f}},[t]);return r.totalTokens===0&&a.length===0?null:e.jsxs("div",{className:"text-[10px] text-muted-foreground py-2",children:[e.jsxs("button",{className:"flex w-full items-center justify-between gap-2 text-muted-foreground/60 hover:text-muted-foreground transition-colors",onClick:()=>{n(!s)},children:[e.jsxs("div",{className:"flex items-center justify-between w-full min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 min-w-0",children:a.length>0&&e.jsx("span",{className:"truncate",children:a.map(i=>i.label).join(", ")})}),r.totalTokens>0&&e.jsxs("span",{className:"tabular-nums whitespace-nowrap",children:[he(r.totalTokens)," ",r.totalTokens===1?"token":"tokens"]})]}),e.jsx(me,{className:`size-3 transition-transform ${s?"rotate-180":""}`})]}),s&&e.jsxs("div",{className:"mt-2 space-y-2 text-muted-foreground/80",children:[a.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium",children:"Models"}),e.jsx("div",{className:"pl-2 text-muted-foreground/60",children:a.map(i=>e.jsx("div",{children:i.provider?`${i.provider}/${i.id}`:i.id},i.id))})]}),r.totalTokens>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium",children:"Token Usage"}),e.jsxs("div",{className:"pl-2 space-y-1 tabular-nums text-muted-foreground/60",children:[r.inputTokens>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Input:"}),e.jsx("span",{children:he(r.inputTokens)})]}),r.outputTokens>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Output:"}),e.jsx("span",{children:he(r.outputTokens)})]}),r.reasoningTokens>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Reasoning:"}),e.jsx("span",{children:he(r.reasoningTokens)})]}),r.cachedInputTokens>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Cached:"}),e.jsx("span",{children:he(r.cachedInputTokens)})]}),e.jsxs("div",{className:"flex justify-between border-t border-muted pt-1 font-medium",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{children:he(r.totalTokens)})]})]})]}),o.requestCount>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium",children:"Performance"}),e.jsxs("div",{className:"pl-2 space-y-1 tabular-nums text-muted-foreground/60",children:[o.avgTokensPerSecond>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Speed:"}),e.jsxs("span",{children:[Math.round(o.avgTokensPerSecond)," tok/s"]})]}),o.avgMsToFirstChunk>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Time to start:"}),e.jsx("span",{children:js(o.avgMsToFirstChunk)})]}),o.avgMsToFinish>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Duration:"}),e.jsx("span",{children:js(o.avgMsToFinish)})]})]})]})]})]})}function xo(t){return t.toLocaleDateString(void 0,{day:"numeric",hour:"2-digit",minute:"2-digit",month:"short"})}const lt=m.memo(function({part:s}){const[n,a]=m.useState(!1),[r,o]=m.useState(!1),i=s.text,c=async()=>{if(!n){a(!0);try{await navigator.clipboard.writeText(i),O.success("Message copied to clipboard")}catch{O.error("Failed to copy message")}finally{a(!1)}}},d=i.length>200||i.split(`
`).length>5;return e.jsxs("div",{className:"group flex flex-col items-end",children:[e.jsxs("div",{className:"bg-muted text-foreground rounded-xl px-4 py-2 border border-border/50 relative max-w-full",children:[e.jsx("div",{className:$("text-sm leading-relaxed prose prose-sm max-w-none dark:prose-invert break-words overflow-wrap-anywhere",d&&!r&&"max-h-32 overflow-hidden cursor-pointer"),onClick:()=>{d&&!r&&o(!0)},children:e.jsx(De,{markdown:i})}),d&&!r&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-muted to-transparent pointer-events-none rounded-b-xl"}),d&&r&&e.jsxs("div",{className:"flex items-center justify-center gap-1 pt-2 cursor-pointer text-xs text-muted-foreground hover:text-foreground transition-colors",onClick:()=>{o(!1)},title:"Click to collapse",children:[e.jsx("span",{children:"Collapse"}),e.jsx(Oe,{className:"size-3"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("span",{children:xo(s.metadata.createdAt)}),e.jsx("button",{"aria-label":"Copy message",className:"p-1 rounded hover:text-foreground hover:bg-muted/50 transition-colors disabled:opacity-50",disabled:n,onClick:c,children:e.jsx(Ze,{size:12})})]})]})});lt.displayName="UserMessageHeader";function fo({app:t,filterMode:s,onContinue:n,selectedVersion:a,sessionId:r}){const{data:o=[],error:i,isLoading:c}=H(_.workspace.message.live.listWithParts.experimental_liveOptions({input:{sessionId:r,subdomain:t.subdomain}})),{selectedSessionId:d}=_e({from:"/_app/projects/$subdomain/"}),{data:u}=Os({subdomain:t.subdomain}),f=be(),l=z(_.workspace.session.create.mutationOptions()),j=()=>{l.mutate({subdomain:t.subdomain},{onError:()=>{O.error("Failed to create new chat")},onSuccess:h=>{f({params:{subdomain:t.subdomain},replace:!0,search:E=>({...E,selectedSessionId:h.id}),to:"/projects/$subdomain"})}})},x=(u?.sessionActors??[]).some(h=>h.sessionId===d&&h.tags.includes("agent.running")),k=u?.checkoutVersionRefActor.status==="active"||u?.createPreviewRefActor.status==="active",T=x||k,w=(u?.sessionActors??[]).some(h=>h.tags.includes("agent.alive")),y=m.useMemo(()=>o.flatMap(h=>h.parts.filter(E=>E.type==="data-gitCommit")),[o]),p=m.useCallback((h,E,C)=>{if(h.type==="text"){if(h.state==="done"&&h.text.trim()==="")return null;switch(E.role){case"assistant":return e.jsx(Ya,{part:h},h.metadata.id);case"session-context":return e.jsx(rt,{message:E,part:h},h.metadata.id);case"user":return e.jsx(lt,{part:h},h.metadata.id);default:return null}}if(h.type==="step-start")return null;if(h.type==="data-gitCommit"){const V=y.at(-1)?.data.ref===h.data.ref;return e.jsx(Ae,{isLastGitCommit:V,isSelected:a===h.data.ref||V&&!a,projectSubdomain:t.subdomain,restoredFromRef:h.data.restoredFromRef,versionRef:h.data.ref},h.metadata.id)}if(At.isToolPart(h))return e.jsx(co,{isAgentRunning:x,part:h},h.metadata.id);if(h.type==="reasoning")return e.jsx(it,{createdAt:h.metadata.createdAt,endedAt:h.metadata.endedAt,isAgentRunning:x,isStreaming:h.state==="streaming",text:h.text},h.metadata.id);if(h.type==="file"||h.type==="source-document"||h.type==="source-url")return console.warn("File part not supported yet",h),null;const R=h;return e.jsx(ho,{part:R},C)},[y,a,t.subdomain,x]),{contextMessages:N,regularMessages:b}=m.useMemo(()=>{const h={contextMessages:[],regularMessages:[]};for(const E of o)E.role==="session-context"?h.contextMessages.push(E):h.regularMessages.push(E);return h},[o]),{chatElements:P}=m.useMemo(()=>{const h=[];let E=0;for(const[C,R]of b.entries()){if(R.role==="user"&&C>0){const V=b.slice(E,C);V.length>0&&(h.push(e.jsx(Me,{data:V,label:"usage-summary",children:e.jsx(ws,{messages:V},`usage-before-${R.id}`)},`usage-before-${R.id}`)),E=C)}const te=[];for(const[V,ne]of R.parts.entries()){const ae=p(ne,R,V);ae&&te.push(e.jsx(Me,{data:ne,label:ne.type,children:ae},ne.metadata.id))}if(R.role==="assistant"&&R.metadata.error){const V=C===b.length-1;te.push(e.jsx(Me,{data:R.metadata.error,label:"error",children:e.jsx(eo,{defaultExpanded:V&&!x&&R.metadata.error.kind!=="aborted",error:R.metadata.error},`error-${R.id}`)},`error-${R.id}`))}h.push(...te)}return{chatElements:h}},[b,p,x]),A=m.useMemo(()=>{if(s!=="chat"||o.length===0||x)return!1;let h=-1;for(let C=o.length-1;C>=0;C--)if(o[C]?.role==="user"){h=C;break}return h===-1?!1:o.slice(h+1).some(C=>C.role==="assistant"&&C.metadata.error&&C.metadata.error.kind!=="aborted"&&C.metadata.error.kind!=="invalid-tool-input"&&C.metadata.error.kind!=="no-such-tool")},[s,o,x]),D=m.useMemo(()=>{if(s!=="chat"||o.length===0||x||!n)return!1;const h=o.at(-1);return h&&h.role==="assistant"&&h.metadata.finishReason==="max-steps"},[s,o,x,n]),M=m.useMemo(()=>y.map(h=>{const E=h.data.ref===y.at(-1)?.data.ref;return e.jsx(Ae,{isLastGitCommit:E,isSelected:a===h.data.ref||E&&!a,projectSubdomain:t.subdomain,restoredFromRef:h.data.restoredFromRef,showCommitMessage:!0,versionRef:h.data.ref},h.data.ref)}),[y,a,t.subdomain]);return e.jsxs(e.Fragment,{children:[c&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(as,{className:"h-4 w-4 animate-spin text-muted-foreground"})}),i&&e.jsx(vs,{message:`Failed to load messages: ${i.message||"Unknown error occurred"}`,onStartNewChat:j}),o.length===0&&!T&&!i&&!c&&e.jsx("div",{className:"text-center text-muted-foreground text-xs",children:s==="versions"?"No versions yet":"No messages yet"}),e.jsxs("div",{className:"w-full flex flex-col gap-2",children:[s==="chat"&&N.length>0&&e.jsx(Za,{messages:N}),e.jsx("div",{className:"flex flex-col gap-2",children:s==="chat"?P:M}),s==="chat"&&T&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(as,{className:"h-4 w-4 animate-spin text-muted-foreground"})}),A&&e.jsx(vs,{onStartNewChat:j}),D&&e.jsxs($s,{className:"mt-4",variant:"warning",children:[e.jsx(ye,{}),e.jsxs(Ls,{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"text-xs",children:"Agent was stopped due to reaching maximum unattended steps."}),e.jsx(I,{onClick:n,size:"sm",variant:"secondary",children:"Resume the agent"})]})]}),s==="chat"&&!w&&o.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-[10px] flex items-center justify-between text-xs text-muted-foreground/60",children:[e.jsx("span",{children:"Total chat usage"}),e.jsxs("span",{children:[o.length," ",o.length===1?"message":"messages"]})]}),e.jsx(ws,{messages:o})]})]})]})}var Le="Tabs",[po,mr]=Cs(Le,[Ps]),ct=Ps(),[go,ts]=po(Le),dt=m.forwardRef((t,s)=>{const{__scopeTabs:n,value:a,onValueChange:r,defaultValue:o,orientation:i="horizontal",dir:c,activationMode:d="automatic",...u}=t,f=jn(c),[l,j]=Ot({prop:a,onChange:r,defaultProp:o??"",caller:Le});return e.jsx(go,{scope:n,baseId:Sn(),value:l,onValueChange:j,orientation:i,dir:f,activationMode:d,children:e.jsx(Ie.div,{dir:f,"data-orientation":i,...u,ref:s})})});dt.displayName=Le;var ut="TabsList",mt=m.forwardRef((t,s)=>{const{__scopeTabs:n,loop:a=!0,...r}=t,o=ts(ut,n),i=ct(n);return e.jsx(bn,{asChild:!0,...i,orientation:o.orientation,dir:o.dir,loop:a,children:e.jsx(Ie.div,{role:"tablist","aria-orientation":o.orientation,...r,ref:s})})});mt.displayName=ut;var ht="TabsTrigger",xt=m.forwardRef((t,s)=>{const{__scopeTabs:n,value:a,disabled:r=!1,...o}=t,i=ts(ht,n),c=ct(n),d=pt(i.baseId,a),u=gt(i.baseId,a),f=a===i.value;return e.jsx(wn,{asChild:!0,...c,focusable:!r,active:f,children:e.jsx(Ie.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":u,"data-state":f?"active":"inactive","data-disabled":r?"":void 0,disabled:r,id:d,...o,ref:s,onMouseDown:Te(t.onMouseDown,l=>{!r&&l.button===0&&l.ctrlKey===!1?i.onValueChange(a):l.preventDefault()}),onKeyDown:Te(t.onKeyDown,l=>{[" ","Enter"].includes(l.key)&&i.onValueChange(a)}),onFocus:Te(t.onFocus,()=>{const l=i.activationMode!=="manual";!f&&!r&&l&&i.onValueChange(a)})})})});xt.displayName=ht;var ft="TabsContent",vo=m.forwardRef((t,s)=>{const{__scopeTabs:n,value:a,forceMount:r,children:o,...i}=t,c=ts(ft,n),d=pt(c.baseId,a),u=gt(c.baseId,a),f=a===c.value,l=m.useRef(f);return m.useEffect(()=>{const j=requestAnimationFrame(()=>l.current=!1);return()=>cancelAnimationFrame(j)},[]),e.jsx(Tn,{present:r||f,children:({present:j})=>e.jsx(Ie.div,{"data-state":f?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!j,id:u,tabIndex:0,...i,ref:s,style:{...t.style,animationDuration:l.current?"0s":void 0},children:j&&o})})});vo.displayName=ft;function pt(t,s){return`${t}-trigger-${s}`}function gt(t,s){return`${t}-content-${s}`}var jo=dt,bo=mt,wo=xt;function No({className:t,...s}){return e.jsx(jo,{className:$("flex flex-col gap-2",t),"data-slot":"tabs",...s})}function yo({className:t,...s}){return e.jsx(bo,{className:$("bg-muted dark:bg-transparent text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),"data-slot":"tabs-list",...s})}function Ns({className:t,...s}){return e.jsx(wo,{className:$("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),"data-slot":"tabs-trigger",...s})}function ko({collapsed:t=!1,project:s,selectedModelURI:n,selectedVersion:a}){const{selectedSessionId:r}=_e({from:"/_app/projects/$subdomain/"}),o=be(),{contentRef:i,isNearBottom:c,scrollRef:d,scrollToBottom:u}=ot({mass:.8}),f=z(_.workspace.session.createWithMessage.mutationOptions()),l=z(_.workspace.message.create.mutationOptions()),j=z(_.workspace.session.stop.mutationOptions()),x=z(_.workspace.session.create.mutationOptions()),k=m.useRef(null),T=m.useRef(null),[w,y]=m.useState(0),[p,N]=m.useState("chat"),[b,P]=m.useState(n),{data:A}=Os({subdomain:s.subdomain});m.useEffect(()=>{P(n)},[n]);const M=(A?.sessionActors??[]).some(C=>C.tags.includes("agent.alive")),h=()=>{if(!r||!b)return;const C=ce.newMessageId(),R=new Date;l.mutate({message:{id:C,metadata:{createdAt:R,sessionId:r},parts:[{metadata:{createdAt:R,id:ce.newPartId(),messageId:C,sessionId:r},text:"Continue",type:"text"}],role:"user"},modelURI:b,sessionId:r,subdomain:s.subdomain},{onSuccess:()=>{N("chat")}})},E=()=>{x.mutate({subdomain:s.subdomain},{onError:()=>{O.error("Failed to create new chat")},onSuccess:C=>{o({params:{subdomain:s.subdomain},replace:!0,search:R=>({...R,selectedSessionId:C.id}),to:"/projects/$subdomain"}).then(()=>{T.current?.focus()})}})};return m.useEffect(()=>{if(!k.current)return;const C=new ResizeObserver(R=>{for(const te of R)y(te.contentRect.height)});return C.observe(k.current),()=>{C.disconnect()}},[]),e.jsxs("div",{className:`bg-background flex flex-col relative transition-all duration-300 ease-in-out ${t?"w-0 overflow-hidden":"w-96 shrink-0"}`,children:[e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(No,{onValueChange:C=>{N(C)},value:p,children:e.jsxs(yo,{children:[e.jsx(Ns,{value:"chat",children:"Chat"}),e.jsx(Ns,{value:"versions",children:"Versions"})]})}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs(Je,{children:[e.jsx(Ke,{asChild:!0,children:e.jsx(I,{disabled:x.isPending,onClick:E,size:"sm",variant:"ghost",children:e.jsx(Cn,{className:"size-4"})})}),e.jsx(Qe,{children:e.jsx("p",{children:"New chat"})})]}),e.jsx(Xa,{project:s})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",ref:d,children:e.jsx("div",{className:"flex flex-col gap-4",ref:i,children:r?e.jsx(fo,{app:s,filterMode:p,onContinue:h,selectedVersion:a,sessionId:r}):e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{children:"No chat selected"})})})}),!c&&e.jsx(I,{className:"absolute left-1/2 transform -translate-x-1/2 z-10 shadow-lg border border-border",onClick:()=>u(),size:"icon",style:{bottom:`${w+48}px`},variant:"secondary",children:e.jsx(me,{className:"h-3 w-3"})}),p==="chat"&&e.jsx("div",{className:"p-4 border-t",ref:k,children:e.jsx(ln,{autoFocus:!0,isLoading:f.isPending||l.isPending,isStoppable:M,isSubmittable:!M,modelURI:b,onModelChange:P,onStop:()=>{j.mutate({subdomain:s.subdomain})},onSubmit:({modelURI:C,prompt:R})=>{const te=R.trim(),V=ce.newMessageId(),ne=new Date;if(r)l.mutate({message:{id:V,metadata:{createdAt:ne,sessionId:r},parts:[{metadata:{createdAt:ne,id:ce.newPartId(),messageId:V,sessionId:r},text:te,type:"text"}],role:"user"},modelURI:C,sessionId:r,subdomain:s.subdomain},{onSuccess:()=>{N("chat"),u(),a&&o({params:{subdomain:s.subdomain},replace:!0,search:ae=>({...ae,selectedVersion:void 0}),to:"/projects/$subdomain"})}});else{const ae=ce.newSessionId();f.mutate({message:{id:V,metadata:{createdAt:ne,sessionId:ae},parts:[{metadata:{createdAt:ne,id:ce.newPartId(),messageId:V,sessionId:ae},text:te,type:"text"}],role:"user"},modelURI:C,sessionId:ae,subdomain:s.subdomain},{onSuccess:()=>{N("chat"),u(),o({params:{subdomain:s.subdomain},replace:!0,search:ns=>({...ns,selectedSessionId:ae,selectedVersion:a?void 0:ns.selectedVersion}),to:"/projects/$subdomain"})}})}},ref:T})})]})}function So({projectSubdomain:t,versionRef:s}){const[n,a]=m.useState(!1),r=m.useRef(null),o=Pt(r),i=_t.parse(`version-${s}.${t}`),{data:c,isLoading:d}=H(_.workspace.app.bySubdomain.queryOptions({input:{subdomain:i}}));return d?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"text-center space-y-6 px-6 py-8 bg-background/90 rounded-lg border shadow-lg",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading version..."})]})}):c?e.jsxs("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm flex z-50",children:[e.jsx("div",{className:"w-full h-full bg-background/95 flex flex-col overflow-hidden",children:e.jsx(Ts,{app:c,iframeRef:r},c.subdomain)}),e.jsx(at,{isOpen:n,onClose:()=>{a(!1)},onRestore:o.reloadWindow,projectSubdomain:t,versionRef:s})]}):e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"text-center space-y-6 px-6 py-8 bg-background/90 rounded-lg border shadow-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Version not found"}),e.jsx(Ss,{className:"text-sm text-primary hover:underline",from:"/projects/$subdomain",params:{subdomain:Dt.parse(t)},search:u=>({...u,selectedVersion:void 0}),children:"Close"})]})})}function To(t){const s=It();m.useEffect(()=>{t&&s.invalidate({filter:n=>n.routeId==="/_app/projects/$subdomain/"&&n.params.subdomain===t.subdomain})},[s,t])}function hr(){const{subdomain:t}=os.useParams(),{selectedVersion:s,showDelete:n}=os.useSearch(),a=m.useRef(null),r=be(),[o,i]=m.useState(!1),[c,d]=m.useState(!1);m.useEffect(()=>{n&&(i(!0),r({from:"/projects/$subdomain",params:{subdomain:t},replace:!0,search:y=>({...y,showDelete:void 0})}))},[n,r,t]);const{data:u,error:f,isLoading:l}=H(_.workspace.project.live.bySubdomain.experimental_liveOptions({input:{subdomain:t},placeholderData:rs})),{data:j,error:x,isLoading:k}=H(_.workspace.project.state.get.queryOptions({input:{subdomain:t},placeholderData:rs}));To(u);const T=l||k,w=f??x;return T?null:w&&!(w instanceof Et)?e.jsx("div",{children:w.message}):!u||!j?null:e.jsxs("div",{className:"flex flex-col h-dvh w-full overflow-hidden",children:[e.jsx(Ba,{iframeRef:a,onDeleteClick:()=>{i(!0)},onSidebarToggle:()=>{d(!c)},project:u,selectedVersion:s,sidebarCollapsed:c}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsx(ko,{collapsed:c,project:u,selectedModelURI:j.selectedModelURI,selectedVersion:s}),e.jsxs("div",{className:$("flex-1 flex flex-col p-2 bg-secondary border-t overflow-hidden",!c&&"border-l rounded-tl-lg"),children:[e.jsx(Ha,{iframeRef:a,project:u,selectedVersion:s,subdomain:t}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Ts,{app:u,iframeRef:a},u.subdomain),s&&e.jsx(So,{projectSubdomain:t,versionRef:s})]})]})]}),e.jsx(_a,{onOpenChange:i,open:o,project:u})]})}export{hr as component};
