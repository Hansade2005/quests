import{f as R,r as c,e as _,b as k,j as e,c as q,B as g,q as W,v as Z,a as F,R as I}from"./browser-ByRVlxZs.js";import{D as L,a as O,b as S,c as w,d as D,e as z}from"./dialog-CXGJl-o7.js";import{I as E}from"./input-b4JxTlpn.js";import{L as B}from"./label-BtiHOr9H.js";import{A as J,S as X,a as P,R as K,g as A}from"./provider-metadata-CugWU6eq.js";import{s as Y}from"./selected-models-DKFAL_fl.js";import{A as y,a as f}from"./alert-C0unLOum.js";import{B as ee,C as T}from"./badge-C-47JFJQ.js";import{E as M}from"./external-link-CNRFkGVF.js";import{u as se}from"./react-MNBroJ8M.js";import{P as te}from"./plus-Df7A54Wp.js";import"./index-BLI4MUby.js";import"./index-Dc_FVRD7.js";import"./index-2emEW3K2.js";import"./index-DCjjJrI9.js";import"./x-CEbMeDD8.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],re=R("award",ae);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]],ne=R("chef-hat",ie);function oe({onOpenChange:o,onSuccess:d,open:t,providers:a=[]}){const[r,n]=se(Y),[N,p]=c.useState("provider-selection"),[i,u]=c.useState(void 0),l=i?A(i):void 0,[h,b]=c.useState(""),[v,j]=c.useState(null),C=_(k.provider.create.mutationOptions());c.useEffect(()=>{t&&(b(""),j(null),u(void 0),p("provider-selection"))},[t]);const U=s=>{u(s),j(null),p("configuration")},$=()=>{p("provider-selection"),u(void 0),j(null)},V=s=>{b(s),j(null)},G=async()=>{if(!(!i||l?.requiresAPIKey&&!h)&&(await C.mutateAsync({apiKey:l?.requiresAPIKey?h:"NOT_NEEDED",type:i},{onError:s=>{W(s)?j(s.message):j("Failed to validate provider")},onSuccess:()=>{d?.()}}),a.length===0||!r)){const{models:s}=await Z.gateway.models.list(),m=s.find(x=>x.tags.includes("default"));m&&n(m.uri)}},H=()=>e.jsxs(e.Fragment,{children:[e.jsxs(S,{children:[e.jsx(w,{children:"Add Provider"}),e.jsx(D,{children:"Choose a provider type to add a new AI provider."})]}),e.jsxs("div",{className:"py-4",children:[a.length===J.length&&e.jsxs(y,{className:"mb-4",children:[e.jsx(ne,{className:"size-4 animate-bounce"}),e.jsx(f,{children:"Wow, you added all of the providers. It's time to get cooking."})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:X.map(s=>{const m=a.some(x=>x.type===s.type);return e.jsxs("button",{className:q("p-3 rounded-lg border text-left transition-colors flex flex-col gap-2 min-h-34",m?"border-muted bg-muted/50 cursor-not-allowed opacity-60":"border-border hover:border-ring hover:bg-accent cursor-pointer"),disabled:m,onClick:()=>{m||U(s.type)},type:"button",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"opacity-80 size-4.5",type:s.type}),e.jsx("div",{className:"font-medium",children:s.name})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.description}),s.tags.length>0&&!m&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-auto",children:s.tags.map(x=>e.jsxs(ee,{variant:x===K?"brand-outline":"outline",children:[x===K&&e.jsx(re,{className:"size-3"}),x]},x))}),m&&e.jsx("div",{className:"text-xs text-muted-foreground",children:"Already added"})]},s.type)})})]})]}),Q=()=>e.jsxs(e.Fragment,{children:[e.jsxs(S,{children:[e.jsxs(w,{className:"flex items-center gap-2",children:[i&&e.jsx(P,{type:i}),l?.name??"Provider"]}),e.jsx(D,{children:i?A(i).description:"Configure your provider settings."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[i&&l?.requiresAPIKey&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(B,{htmlFor:"api-key",children:"API Key"}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsxs("a",{className:"inline-flex items-center gap-1 text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 underline underline-offset-2",href:l.apiKeyURL,rel:"noopener noreferrer",target:"_blank",children:["Get your API key",e.jsx(M,{className:"h-3 w-3"})]}),e.jsx("span",{children:"or"}),e.jsxs("a",{className:"inline-flex items-center gap-1 text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 underline underline-offset-2",href:l.url,rel:"noopener noreferrer",target:"_blank",children:["learn more",e.jsx(M,{className:"h-3 w-3"})]})]})]}),e.jsx(E,{autoFocus:!0,className:"font-mono",id:"api-key",onChange:s=>{V(s.target.value)},placeholder:`${l.apiKeyFormat??""}...xyz123`,spellCheck:!1,type:"text",value:h})]}),i&&!l?.requiresAPIKey&&e.jsx(y,{children:e.jsx(f,{className:"text-center",children:"No additional configuration required for this provider."})}),v&&e.jsxs(y,{variant:"destructive",children:[e.jsx(T,{}),e.jsx(f,{children:v})]})]}),e.jsxs(z,{className:"flex gap-2",children:[e.jsx(g,{onClick:$,type:"button",variant:"secondary",children:"Back"}),e.jsx(g,{disabled:C.isPending||!i||l?.requiresAPIKey&&!h,onClick:G,children:C.isPending?"Saving...":"Save"})]})]});return e.jsx(L,{onOpenChange:o,open:t,children:e.jsx(O,{className:"sm:max-w-xl",children:N==="provider-selection"?H():Q()})})}function le({onOpenChange:o,onSuccess:d,open:t,provider:a}){const r=A(a.type),[n,N]=c.useState(""),[p,i]=c.useState(null),u=_(k.provider.remove.mutationOptions());c.useEffect(()=>{t&&(N(""),i(null))},[t]);const l=v=>{N(v),i(null)},h=async()=>{await u.mutateAsync({id:a.id},{onError:()=>{i("Failed to remove provider")},onSuccess:()=>{d?.()}})},b=()=>{o(!1)};return e.jsx(L,{onOpenChange:o,open:t,children:e.jsxs(O,{className:"sm:max-w-[425px]",children:[e.jsxs(S,{children:[e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(P,{type:a.type}),r.name]}),e.jsx(D,{children:r.description})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[r.requiresAPIKey&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"space-y-1",children:e.jsx(B,{htmlFor:"api-key",children:"API Key"})}),a.maskedApiKey?e.jsx("div",{className:"relative",children:e.jsx(E,{className:"font-mono pr-10",disabled:!0,id:"api-key",readOnly:!0,spellCheck:!1,type:"text",value:a.maskedApiKey})}):e.jsx(E,{className:"font-mono",id:"api-key",onChange:v=>{l(v.target.value)},placeholder:`${r.apiKeyFormat??""}...xyz123`,spellCheck:!1,type:"text",value:n})]}),!r.requiresAPIKey&&e.jsx(y,{children:e.jsx(f,{className:"text-center",children:"No additional configuration required for this provider."})}),p&&e.jsxs(y,{variant:"destructive",children:[e.jsx(T,{}),e.jsx(f,{children:p})]})]}),e.jsxs(z,{className:"flex gap-2",children:[e.jsx(g,{onClick:b,type:"button",variant:"secondary",children:"Cancel"}),e.jsx(g,{disabled:u.isPending,onClick:h,variant:"destructive",children:u.isPending?"Removing...":"Remove"})]})]})})}const ce=o=>o.toFixed(2);function de({className:o,onConfigure:d,provider:t}){const a=A(t.type),{data:r,isLoading:n}=F({...k.provider.credits.queryOptions({input:{provider:"openrouter"}}),enabled:t.type==="openrouter",refetchInterval:3e4});return e.jsx("div",{className:q("rounded-lg border bg-accent/30 p-4 shadow-sm hover:bg-accent/50 transition-colors",o),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center size-8",children:e.jsx(P,{type:t.type})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium",children:a.name}),t.type==="openrouter"&&e.jsx("span",{className:"text-sm text-muted-foreground",children:n?"Loading credits...":r?.credits?`$${ce(r.credits.total_credits-r.credits.total_usage)} remaining`:"Unable to load credits"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.description})]})]}),e.jsx(g,{onClick:d,size:"sm",variant:"outline",children:"Manage"})]})})}function Se(){const{data:o}=F(k.provider.live.list.experimental_liveOptions()),{showNewProviderDialog:d}=I.useSearch(),t=I.useNavigate(),[a,r]=c.useState(null);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold",children:"AI Providers"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Connect providers to access different models and services."})]}),e.jsxs(g,{onClick:()=>{t({search:{showNewProviderDialog:!0}})},size:"sm",children:[e.jsx(te,{className:"size-4"}),"Add Provider"]})]}),e.jsx("div",{className:"space-y-3",children:o?.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground mt-32",children:e.jsx("p",{className:"text-sm",children:"No providers configured yet."})}):o?.map(n=>e.jsx(de,{onConfigure:()=>{r(n)},provider:n},n.id))}),a&&e.jsx(le,{onOpenChange:n=>{n||r(null)},onSuccess:()=>{r(null)},open:!!a,provider:a}),d&&e.jsx(oe,{onOpenChange:n=>{n||t({search:{}})},onSuccess:()=>{t({search:{}})},open:d,providers:o??[]})]})}export{Se as component};
